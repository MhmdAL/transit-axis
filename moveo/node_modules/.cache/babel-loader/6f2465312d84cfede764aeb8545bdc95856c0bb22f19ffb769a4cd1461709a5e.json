{"ast":null,"code":"var _jsxFileName = \"/home/mhmdal/Projects/moveo-master/moveo/src/components/Map/RouteMap.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { MapContainer, TileLayer, Marker, Polyline, Popup, useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport styled from 'styled-components';\nimport { theme } from '../../styles/theme';\nimport { RoutingService } from '../../services/routingService';\n\n// Fix for default markers in React Leaflet\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png'\n});\n\n// Create custom colored markers\nconst createCustomIcon = color => {\n  return L.divIcon({\n    className: 'custom-marker',\n    html: `\n      <div style=\"\n        background-color: ${color};\n        width: 25px;\n        height: 25px;\n        border-radius: 50% 50% 50% 0;\n        border: 3px solid white;\n        transform: rotate(-45deg);\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      \">\n        <div style=\"\n          transform: rotate(45deg);\n          color: white;\n          font-weight: bold;\n          font-size: 12px;\n        \"></div>\n      </div>\n    `,\n    iconSize: [25, 25],\n    iconAnchor: [12, 24],\n    popupAnchor: [0, -24]\n  });\n};\n\n// Default blue marker for available stops\nconst defaultIcon = createCustomIcon('#3b82f6');\n\n// Green marker for selected stops in route\nconst selectedIcon = createCustomIcon('#10b981');\n\n// Red marker for temporary/pending stops\nconst tempIcon = createCustomIcon('#ef4444');\nconst MapWrapper = styled.div`\n  width: 100%;\n  height: ${({\n  height\n}) => height || '500px'};\n  border: 2px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.lg};\n  overflow: hidden;\n  position: relative;\n  \n  .leaflet-container {\n    height: 100%;\n    width: 100%;\n    background: ${theme.colors.surface};\n  }\n  \n  .leaflet-control-container {\n    .leaflet-control-zoom {\n      background: ${theme.colors.card};\n      border: 1px solid ${theme.colors.border};\n      \n      a {\n        background: ${theme.colors.card};\n        color: ${theme.colors.textPrimary};\n        border-bottom: 1px solid ${theme.colors.border};\n        \n        &:hover {\n          background: ${theme.colors.cardHover};\n        }\n        \n        &:last-child {\n          border-bottom: none;\n        }\n      }\n    }\n    \n    .leaflet-control-attribution {\n      background: rgba(0, 0, 0, 0.8);\n      color: white;\n      font-size: 11px;\n      \n      a {\n        color: #3b82f6;\n      }\n    }\n  }\n  \n  .leaflet-popup-content-wrapper {\n    background: ${theme.colors.card};\n    color: ${theme.colors.textPrimary};\n    border-radius: ${theme.borderRadius.md};\n    box-shadow: ${theme.shadows.lg};\n  }\n  \n  .leaflet-popup-tip {\n    background: ${theme.colors.card};\n  }\n\n  /* Custom marker styles for interactive stops */\n  .leaflet-marker-icon {\n    cursor: pointer;\n    transition: transform 0.2s ease-in-out, filter 0.2s ease-in-out;\n    \n    &:hover {\n      transform: scale(1.1);\n      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));\n    }\n  }\n\n  /* Custom marker styling */\n  .custom-marker {\n    background: transparent !important;\n    border: none !important;\n  }\n`;\n_c = MapWrapper;\nconst MapSidebar = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 300px;\n  height: 100%;\n  background: ${theme.colors.card};\n  border-left: 1px solid ${theme.colors.border};\n  z-index: 1000;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n_c2 = MapSidebar;\nconst SidebarHeader = styled.div`\n  padding: ${theme.spacing.lg};\n  border-bottom: 1px solid ${theme.colors.border};\n  background: ${theme.colors.surface};\n`;\n_c3 = SidebarHeader;\nconst SidebarTitle = styled.h3`\n  margin: 0;\n  font-size: ${theme.typography.fontSize.lg};\n  font-weight: ${theme.typography.fontWeight.semibold};\n  color: ${theme.colors.textPrimary};\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n`;\n_c4 = SidebarTitle;\nconst SidebarContent = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n_c5 = SidebarContent;\nconst ControlSection = styled.div`\n  padding: ${theme.spacing.lg};\n  border-bottom: 1px solid ${theme.colors.border};\n`;\n_c6 = ControlSection;\nconst ControlGroup = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: ${theme.spacing.md};\n`;\n_c7 = ControlGroup;\nconst ToggleButton = styled.button`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${({\n  active\n}) => active ? theme.colors.primary : theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${({\n  active\n}) => active ? theme.colors.primary : theme.colors.surface};\n  color: ${({\n  active\n}) => active ? 'white' : theme.colors.textPrimary};\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  \n  &:hover {\n    background: ${({\n  active\n}) => active ? theme.colors.primary : theme.colors.surfaceHover};\n    transform: translateY(-1px);\n  }\n`;\n_c8 = ToggleButton;\nconst ActionButton = styled.button`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${theme.colors.surface};\n  color: ${theme.colors.textPrimary};\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  \n  &:hover {\n    background: ${theme.colors.surfaceHover};\n    transform: translateY(-1px);\n  }\n  \n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n  }\n`;\n_c9 = ActionButton;\nconst SearchSection = styled.div`\n  display: flex;\n  flex-direction: column;\n  overflow: visible;\n`;\n_c0 = SearchSection;\nconst SearchContainer = styled.div`\n  position: relative;\n  padding: ${theme.spacing.lg} ${theme.spacing.lg} ${theme.spacing.md};\n  overflow: visible;\n`;\n_c1 = SearchContainer;\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${theme.colors.surface};\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n  transition: all 0.2s ease-in-out;\n  \n  &:focus {\n    outline: none;\n    border-color: ${theme.colors.primary};\n    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n  }\n  \n  &::placeholder {\n    color: ${theme.colors.textMuted};\n  }\n`;\n_c10 = SearchInput;\nconst SearchDropdown = styled.div`\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  border-top: none;\n  border-radius: 0 0 ${theme.borderRadius.md} ${theme.borderRadius.md};\n  box-shadow: ${theme.shadows.lg};\n  z-index: 1000;\n  max-height: 200px;\n  min-height: 40px;\n  overflow-y: auto;\n  display: ${({\n  isOpen\n}) => isOpen ? 'block' : 'none'};\n  transition: all 0.2s ease-in-out;\n`;\n_c11 = SearchDropdown;\nconst DropdownItem = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border-bottom: 1px solid ${theme.colors.border};\n  \n  background: ${theme.colors.surface};\n    \n  &:hover {\n    background: ${theme.colors.surfaceHover};\n  }\n  \n  &:last-child {\n    border-bottom: none;\n  }\n`;\n_c12 = DropdownItem;\nconst DropdownItemInfo = styled.div`\n  flex: 1;\n  min-width: 0;\n`;\n_c13 = DropdownItemInfo;\nconst DropdownItemName = styled.div`\n  font-weight: ${theme.typography.fontWeight.medium};\n  color: inherit;\n  font-size: ${theme.typography.fontSize.sm};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n_c14 = DropdownItemName;\nconst DropdownItemCode = styled.div`\n  color: ${theme.colors.textSecondary};\n  font-size: ${theme.typography.fontSize.xs};\n  margin-top: ${theme.spacing.xs};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n_c15 = DropdownItemCode;\nconst NoResults = styled.div`\n  padding: ${theme.spacing.md};\n  text-align: center;\n  color: ${theme.colors.textMuted};\n  font-size: ${theme.typography.fontSize.sm};\n`;\n_c16 = NoResults;\nconst SelectedStopsSection = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n_c17 = SelectedStopsSection;\nconst SelectedStopsHeader = styled.div`\n  padding: 0 ${theme.spacing.lg} ${theme.spacing.sm};\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  color: ${theme.colors.textSecondary};\n`;\n_c18 = SelectedStopsHeader;\nconst SelectedStopsList = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: ${theme.spacing.md} ${theme.spacing.lg};\n`;\n_c19 = SelectedStopsList;\nconst SelectedStopItem = styled.div`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  margin-bottom: ${theme.spacing.xs};\n  background: ${theme.colors.surface};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  transition: all 0.2s ease-in-out;\n  \n  &:hover {\n    background: ${theme.colors.surfaceHover};\n    transform: translateY(-1px);\n    box-shadow: ${theme.shadows.sm};\n  }\n`;\n_c20 = SelectedStopItem;\nconst StopOrder = styled.div`\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  background: ${theme.colors.primary};\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: ${theme.typography.fontWeight.bold};\n  font-size: ${theme.typography.fontSize.xs};\n  flex-shrink: 0;\n`;\n_c21 = StopOrder;\nconst StopInfo = styled.div`\n  flex: 1;\n  min-width: 0;\n`;\n_c22 = StopInfo;\nconst StopName = styled.div`\n  font-weight: ${theme.typography.fontWeight.medium};\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n_c23 = StopName;\nconst StopCode = styled.div`\n  color: ${theme.colors.textSecondary};\n  font-size: ${theme.typography.fontSize.xs};\n  margin-top: ${theme.spacing.xs};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n_c24 = StopCode;\nconst RemoveButton = styled.button`\n  color: ${theme.colors.error};\n  padding: ${theme.spacing.xs};\n  border-radius: ${theme.borderRadius.sm};\n  transition: all 0.2s ease-in-out;\n  \n  &:hover {\n    background: rgba(239, 68, 68, 0.1);\n    transform: scale(1.1);\n  }\n`;\n_c25 = RemoveButton;\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: ${theme.spacing.xl};\n  color: ${theme.colors.textMuted};\n`;\n_c26 = EmptyState;\nconst MapInfo = styled.div`\n  position: absolute;\n  top: ${theme.spacing.md};\n  left: ${theme.spacing.md};\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border-radius: ${theme.borderRadius.md};\n  font-size: ${theme.typography.fontSize.sm};\n  z-index: 1000;\n  pointer-events: none;\n  max-width: 250px;\n`;\n_c27 = MapInfo;\nconst RouteInfo = styled.div`\n  position: absolute;\n  top: ${theme.spacing.md};\n  right: ${theme.spacing.md};\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border-radius: ${theme.borderRadius.md};\n  font-size: ${theme.typography.fontSize.sm};\n  z-index: 1000;\n  pointer-events: none;\n  min-width: 150px;\n`;\nconst RouteInfoItem = styled.div`\n  margin: 2px 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n`;\nconst PopupContent = styled.div`\n  min-width: 200px;\n`;\n_c28 = PopupContent;\nconst PopupTitle = styled.h4`\n  margin: 0 0 ${theme.spacing.sm} 0;\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n`;\n_c29 = PopupTitle;\nconst PopupDetail = styled.div`\n  margin: ${theme.spacing.xs} 0;\n  font-size: ${theme.typography.fontSize.xs};\n  color: ${theme.colors.textSecondary};\n`;\n\n// Component to fit all available stops into view\n_c30 = PopupDetail;\nconst FitAllStopsHandler = ({\n  stops\n}) => {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    if (stops.length === 0) return;\n    try {\n      // Create bounds from all stops - convert string coords to numbers\n      const bounds = L.latLngBounds(stops.map(stop => [parseFloat(stop.location.lat.toString()), parseFloat(stop.location.lon.toString())]));\n\n      // Fit the map to show all stops\n      map.fitBounds(bounds, {\n        padding: [50, 50],\n        maxZoom: 16\n      });\n    } catch (error) {\n      console.error('Error fitting stops to view:', error);\n    }\n  }, [map, stops.length]);\n  return null;\n};\n\n// Component to handle map bounds fitting\n_s(FitAllStopsHandler, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c31 = FitAllStopsHandler;\nconst MapBoundsHandler = ({\n  selectedStops\n}) => {\n  _s2();\n  const map = useMap();\n  useEffect(() => {\n    if (selectedStops.length > 0) {\n      // Create bounds from selected stops - convert string coords to numbers\n      const bounds = L.latLngBounds(selectedStops.map(stop => [parseFloat(stop.location.lat.toString()), parseFloat(stop.location.lon.toString())]));\n\n      // Fit the map to show all selected stops with some padding\n      if (selectedStops.length === 1) {\n        // For single stop, just center on it with a reasonable zoom\n        const lat = parseFloat(selectedStops[0].location.lat.toString());\n        const lon = parseFloat(selectedStops[0].location.lon.toString());\n        map.setView([lat, lon], 14);\n      } else {\n        // For multiple stops, fit bounds with padding\n        map.fitBounds(bounds, {\n          padding: [20, 20],\n          maxZoom: 16\n        });\n      }\n    }\n  }, [map, selectedStops]);\n  return null;\n};\n\n// Component to handle map clicks for manual stop addition\n_s2(MapBoundsHandler, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c32 = MapBoundsHandler;\nconst MapClickHandler = ({\n  onMapClick,\n  isManualAddMode = false\n}) => {\n  _s3();\n  const map = useMap();\n  useEffect(() => {\n    console.log('ðŸ–±ï¸ MapClickHandler Setup:', {\n      isManualAddMode,\n      hasCallback: !!onMapClick\n    });\n    if (!isManualAddMode || !onMapClick) {\n      console.log('â­ï¸ MapClickHandler - mode disabled or no callback');\n      return;\n    }\n    const handleClick = e => {\n      var _e$latlng, _e$latlng2;\n      console.log('ðŸŽ¯ MAP CLICKED event:', e);\n      const lat = (_e$latlng = e.latlng) === null || _e$latlng === void 0 ? void 0 : _e$latlng.lat;\n      const lng = (_e$latlng2 = e.latlng) === null || _e$latlng2 === void 0 ? void 0 : _e$latlng2.lng;\n      console.log('ðŸŽ¯ MAP CLICKED at:', {\n        lat,\n        lng,\n        isManualAddMode\n      });\n      if (lat !== undefined && lng !== undefined) {\n        onMapClick(lat, lng);\n      }\n    };\n    console.log('âœ… Attaching click handler to map');\n\n    // Try both methods\n    map.on('click', handleClick);\n    return () => {\n      console.log('âŒ Detaching click handler');\n      map.off('click', handleClick);\n    };\n  }, [map, onMapClick, isManualAddMode]);\n  return null;\n};\n_s3(MapClickHandler, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c33 = MapClickHandler;\nconst RouteMap = ({\n  stops,\n  selectedStops,\n  center,\n  zoom = 12,\n  showRoute = true,\n  height,\n  onStopClick,\n  onFitRoute,\n  showAllStops = true,\n  onToggleShowAllStops,\n  searchTerm = '',\n  onSearchChange,\n  filteredStops = [],\n  onAddStop,\n  onRemoveStop,\n  onMapClick,\n  isManualAddMode = false,\n  onToggleManualMode,\n  tempMarker\n}) => {\n  _s4();\n  // Default center - Qatar (Doha) if no center provided\n  const defaultCenter = center || {\n    lat: 25.2854,\n    lng: 51.5310\n  };\n\n  // State for route data\n  const [routeData, setRouteData] = useState(null);\n  const [isCalculatingRoute, setIsCalculatingRoute] = useState(false);\n  const [isSearchDropdownOpen, setIsSearchDropdownOpen] = useState(false);\n\n  // Debug: Log stops and manual mode\n  useEffect(() => {\n    console.log('RouteMap Debug:', {\n      stopsCount: stops.length,\n      selectedStopsCount: selectedStops.length,\n      isManualAddMode,\n      showAllStops,\n      defaultCenter,\n      stopsArray: stops.slice(0, 3) // First 3 stops\n    });\n  }, [stops.length, selectedStops.length, isManualAddMode, showAllStops, defaultCenter]);\n\n  // Calculate route when selected stops change\n  useEffect(() => {\n    // Create an AbortController for this effect\n    const abortController = new AbortController();\n    let timeoutId;\n    if (selectedStops.length >= 2 && showRoute) {\n      setIsCalculatingRoute(true);\n      const waypoints = selectedStops.map(stop => ({\n        lat: parseFloat(stop.location.lat.toString()),\n        lng: parseFloat(stop.location.lon.toString())\n      }));\n\n      // Create a stable key for this route calculation\n      //   const routeKey = waypoints.map(w => `${w.lat.toFixed(6)},${w.lng.toFixed(6)}`).join('|');\n\n      // Add a longer delay to avoid excessive API calls during hot reload\n      timeoutId = setTimeout(async () => {\n        // Check if component is still mounted and request not aborted\n        if (abortController.signal.aborted) {\n          return;\n        }\n        try {\n          const route = await RoutingService.calculateRoute(waypoints, abortController.signal);\n\n          // Check again if component is still mounted\n          if (!abortController.signal.aborted) {\n            setRouteData(route);\n            setIsCalculatingRoute(false);\n          }\n        } catch (error) {\n          // Only handle error if not aborted\n          if (!abortController.signal.aborted) {\n            console.error('Failed to calculate route:', error);\n            setIsCalculatingRoute(false);\n            // Fallback to straight line\n            setRouteData({\n              coordinates: waypoints,\n              distance: 0,\n              duration: 0\n            });\n          }\n        }\n      }, 1000); // Increased to 1 second to reduce hot reload requests\n    } else {\n      setRouteData(null);\n      setIsCalculatingRoute(false);\n    }\n\n    // Cleanup function\n    return () => {\n      abortController.abort();\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n    };\n  }, [selectedStops, showRoute]);\n\n  // Create route line coordinates for Leaflet Polyline\n  const routeCoordinates = routeData ? routeData.coordinates.map(coord => [coord.lat, coord.lng]) : selectedStops.map(stop => [stop.location.lat, stop.location.lon]);\n\n  // Search handlers\n  const handleSearchChange = value => {\n    onSearchChange === null || onSearchChange === void 0 ? void 0 : onSearchChange(value);\n    const shouldOpen = value.length > 0;\n    console.log('Search change:', value, 'Should open:', shouldOpen, 'Filtered stops:', filteredStops.length);\n    setIsSearchDropdownOpen(shouldOpen);\n  };\n  const handleSearchFocus = () => {\n    console.log('Search focus, searchTerm:', searchTerm, 'length:', searchTerm.length);\n    if (searchTerm.length > 0) {\n      setIsSearchDropdownOpen(true);\n    }\n  };\n  const handleSearchBlur = () => {\n    // Delay closing to allow for click on dropdown item\n    setTimeout(() => {\n      setIsSearchDropdownOpen(false);\n    }, 200);\n  };\n  const handleDropdownItemClick = stop => {\n    onAddStop === null || onAddStop === void 0 ? void 0 : onAddStop(stop);\n    onSearchChange === null || onSearchChange === void 0 ? void 0 : onSearchChange('');\n    setIsSearchDropdownOpen(false);\n  };\n  return /*#__PURE__*/_jsxDEV(MapWrapper, {\n    children: [onStopClick && /*#__PURE__*/_jsxDEV(MapInfo, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '12px',\n          opacity: 0.8\n        },\n        children: \"\\uD83D\\uDCCD Click stops to add to route\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 725,\n        columnNumber: 11\n      }, this), isCalculatingRoute && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '4px',\n          fontSize: '12px',\n          opacity: 0.8,\n          color: '#3b82f6'\n        },\n        children: \"\\uD83D\\uDEE3\\uFE0F Calculating road route...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 729,\n        columnNumber: 13\n      }, this), selectedStops.length === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '4px',\n          fontSize: '12px',\n          opacity: 0.8\n        },\n        children: \"Add another stop to see route\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 734,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 724,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(MapSidebar, {\n      children: [/*#__PURE__*/_jsxDEV(SidebarHeader, {\n        children: /*#__PURE__*/_jsxDEV(SidebarTitle, {\n          children: \"\\uD83D\\uDDFA\\uFE0F Route Builder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 745,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 744,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SidebarContent, {\n        children: [/*#__PURE__*/_jsxDEV(ControlSection, {\n          children: /*#__PURE__*/_jsxDEV(ControlGroup, {\n            children: [onToggleShowAllStops && /*#__PURE__*/_jsxDEV(ToggleButton, {\n              active: showAllStops,\n              onClick: onToggleShowAllStops,\n              children: [\"\\uD83D\\uDCCD \", showAllStops ? 'Hide All Stops' : 'Show All Stops']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 755,\n              columnNumber: 17\n            }, this), onToggleManualMode && /*#__PURE__*/_jsxDEV(ToggleButton, {\n              active: isManualAddMode,\n              onClick: onToggleManualMode,\n              children: [\"\\uD83D\\uDCCC \", isManualAddMode ? 'Stop Placement Mode' : 'Click to Add Stops']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 764,\n              columnNumber: 17\n            }, this), selectedStops.length >= 2 && onFitRoute && /*#__PURE__*/_jsxDEV(ActionButton, {\n              onClick: onFitRoute,\n              children: \"\\uD83C\\uDFAF Fit Route to View\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 773,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 753,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 752,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SearchSection, {\n          children: /*#__PURE__*/_jsxDEV(SearchContainer, {\n            children: [/*#__PURE__*/_jsxDEV(SearchInput, {\n              type: \"text\",\n              placeholder: \"Search stops to add...\",\n              value: searchTerm,\n              onChange: e => handleSearchChange(e.target.value),\n              onFocus: handleSearchFocus,\n              onBlur: handleSearchBlur\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 783,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(SearchDropdown, {\n              isOpen: isSearchDropdownOpen,\n              children: filteredStops.length > 0 ? filteredStops.map(stop => {\n                const isSelected = selectedStops.some(s => s.id === stop.id);\n                return /*#__PURE__*/_jsxDEV(DropdownItem, {\n                  selected: isSelected,\n                  onClick: () => !isSelected && handleDropdownItemClick(stop),\n                  children: [/*#__PURE__*/_jsxDEV(DropdownItemInfo, {\n                    children: [/*#__PURE__*/_jsxDEV(DropdownItemName, {\n                      children: stop.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 804,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(DropdownItemCode, {\n                      children: stop.code\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 805,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 803,\n                    columnNumber: 25\n                  }, this), !isSelected && /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      color: theme.colors.primary,\n                      fontSize: '16px'\n                    },\n                    children: \"+\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 808,\n                    columnNumber: 27\n                  }, this)]\n                }, stop.id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 798,\n                  columnNumber: 23\n                }, this);\n              }) : /*#__PURE__*/_jsxDEV(NoResults, {\n                children: [\"No stops found for \\\"\", searchTerm, \"\\\"\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 814,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 793,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 782,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 781,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SelectedStopsSection, {\n          children: [/*#__PURE__*/_jsxDEV(SelectedStopsHeader, {\n            children: [\"Selected Stops (\", selectedStops.length, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 824,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SelectedStopsList, {\n            children: selectedStops.length > 0 ? selectedStops.map((stop, index) => /*#__PURE__*/_jsxDEV(SelectedStopItem, {\n              children: [/*#__PURE__*/_jsxDEV(StopOrder, {\n                children: index + 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 832,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(StopInfo, {\n                children: [/*#__PURE__*/_jsxDEV(StopName, {\n                  children: stop.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 834,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(StopCode, {\n                  children: stop.code\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 835,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 833,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(RemoveButton, {\n                onClick: () => onRemoveStop === null || onRemoveStop === void 0 ? void 0 : onRemoveStop(stop.id),\n                children: \"\\xD7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 837,\n                columnNumber: 21\n              }, this)]\n            }, stop.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 831,\n              columnNumber: 19\n            }, this)) : /*#__PURE__*/_jsxDEV(EmptyState, {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '20px',\n                  marginBottom: '8px'\n                },\n                children: \"\\uD83D\\uDCCD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 844,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '12px',\n                  fontWeight: '500'\n                },\n                children: \"No stops selected\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 845,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  fontSize: '10px',\n                  marginTop: '4px',\n                  color: theme.colors.textMuted\n                },\n                children: \"Search and add stops to build your route\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 846,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 843,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 828,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 823,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 750,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 743,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [defaultCenter.lat, defaultCenter.lng],\n      zoom: zoom,\n      style: {\n        height: '100%',\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 861,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapBoundsHandler, {\n        selectedStops: selectedStops\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 867,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FitAllStopsHandler, {\n        stops: stops\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 869,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapClickHandler, {\n        onMapClick: onMapClick,\n        isManualAddMode: isManualAddMode\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 872,\n        columnNumber: 9\n      }, this), (() => {\n        console.log('ðŸ—ºï¸ MAP RENDERING:', {\n          stopsLength: stops.length,\n          showAllStops\n        });\n        const markers = stops.map(stop => {\n          const isSelected = selectedStops.some(s => s.id === stop.id);\n          const selectedIndex = selectedStops.findIndex(s => s.id === stop.id);\n\n          // Only show non-selected stops if showAllStops is true\n          if (!isSelected && !showAllStops) {\n            console.log('â­ï¸ SKIPPING STOP:', stop.name, '(not selected & showAllStops is false)');\n            return null;\n          }\n          const lat = parseFloat(stop.location.lat.toString());\n          const lon = parseFloat(stop.location.lon.toString());\n          console.log('ðŸ“ MARKER RENDER:', {\n            name: stop.name,\n            lat,\n            lon,\n            isSelected\n          });\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            position: [lat, lon],\n            icon: isSelected ? selectedIcon : defaultIcon,\n            eventHandlers: {\n              click: () => {\n                if (onStopClick) {\n                  onStopClick(stop);\n                }\n              }\n            },\n            children: /*#__PURE__*/_jsxDEV(Popup, {\n              children: /*#__PURE__*/_jsxDEV(PopupContent, {\n                children: [/*#__PURE__*/_jsxDEV(PopupTitle, {\n                  children: stop.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 912,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(PopupDetail, {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Code:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 913,\n                    columnNumber: 34\n                  }, this), \" \", stop.code]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 913,\n                  columnNumber: 21\n                }, this), isSelected && /*#__PURE__*/_jsxDEV(PopupDetail, {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Order:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 915,\n                    columnNumber: 36\n                  }, this), \" #\", selectedIndex + 1, \" in route\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 915,\n                  columnNumber: 23\n                }, this), onStopClick && !isSelected && /*#__PURE__*/_jsxDEV(PopupDetail, {\n                  style: {\n                    color: theme.colors.primary,\n                    fontWeight: 'bold',\n                    marginTop: '8px'\n                  },\n                  children: \"Click to add to route\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 918,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 911,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 910,\n              columnNumber: 17\n            }, this)\n          }, stop.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 898,\n            columnNumber: 15\n          }, this);\n        });\n        console.log('ðŸŽ¨ TOTAL MARKERS RENDERED:', markers.filter(m => m !== null).length);\n        return markers;\n      })(), (() => {\n        console.log('ðŸ”´ TEMP MARKER CHECK:', {\n          tempMarker,\n          isManualAddMode,\n          shouldRender: tempMarker && isManualAddMode\n        });\n        if (tempMarker && isManualAddMode) {\n          const lat = parseFloat(tempMarker.lat.toString());\n          const lon = parseFloat(tempMarker.lon.toString());\n          console.log('ðŸ”´ RENDERING TEMP MARKER at:', {\n            lat,\n            lon\n          });\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            position: [lat, lon],\n            icon: tempIcon,\n            children: /*#__PURE__*/_jsxDEV(Popup, {\n              children: /*#__PURE__*/_jsxDEV(PopupContent, {\n                children: [/*#__PURE__*/_jsxDEV(PopupTitle, {\n                  children: \"New Stop Location\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 952,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(PopupDetail, {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Lat:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 953,\n                    columnNumber: 34\n                  }, this), \" \", lat.toFixed(6)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 953,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(PopupDetail, {\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Lon:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 954,\n                    columnNumber: 34\n                  }, this), \" \", lon.toFixed(6)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 954,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 951,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 950,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 946,\n            columnNumber: 15\n          }, this);\n        }\n        return null;\n      })(), showRoute && selectedStops.length > 1 && routeCoordinates.length > 0 && /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: routeCoordinates,\n        color: routeData ? theme.colors.primary : theme.colors.secondary,\n        weight: routeData ? 5 : 4,\n        opacity: routeData ? 0.9 : 0.6,\n        dashArray: routeData ? undefined : \"10, 5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 965,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 856,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 722,\n    columnNumber: 5\n  }, this);\n};\n_s4(RouteMap, \"LW1FyQ8m9Vs+Z/7wNKb90P8p/UY=\");\n_c34 = RouteMap;\nexport default RouteMap;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18, _c19, _c20, _c21, _c22, _c23, _c24, _c25, _c26, _c27, _c28, _c29, _c30, _c31, _c32, _c33, _c34;\n$RefreshReg$(_c, \"MapWrapper\");\n$RefreshReg$(_c2, \"MapSidebar\");\n$RefreshReg$(_c3, \"SidebarHeader\");\n$RefreshReg$(_c4, \"SidebarTitle\");\n$RefreshReg$(_c5, \"SidebarContent\");\n$RefreshReg$(_c6, \"ControlSection\");\n$RefreshReg$(_c7, \"ControlGroup\");\n$RefreshReg$(_c8, \"ToggleButton\");\n$RefreshReg$(_c9, \"ActionButton\");\n$RefreshReg$(_c0, \"SearchSection\");\n$RefreshReg$(_c1, \"SearchContainer\");\n$RefreshReg$(_c10, \"SearchInput\");\n$RefreshReg$(_c11, \"SearchDropdown\");\n$RefreshReg$(_c12, \"DropdownItem\");\n$RefreshReg$(_c13, \"DropdownItemInfo\");\n$RefreshReg$(_c14, \"DropdownItemName\");\n$RefreshReg$(_c15, \"DropdownItemCode\");\n$RefreshReg$(_c16, \"NoResults\");\n$RefreshReg$(_c17, \"SelectedStopsSection\");\n$RefreshReg$(_c18, \"SelectedStopsHeader\");\n$RefreshReg$(_c19, \"SelectedStopsList\");\n$RefreshReg$(_c20, \"SelectedStopItem\");\n$RefreshReg$(_c21, \"StopOrder\");\n$RefreshReg$(_c22, \"StopInfo\");\n$RefreshReg$(_c23, \"StopName\");\n$RefreshReg$(_c24, \"StopCode\");\n$RefreshReg$(_c25, \"RemoveButton\");\n$RefreshReg$(_c26, \"EmptyState\");\n$RefreshReg$(_c27, \"MapInfo\");\n$RefreshReg$(_c28, \"PopupContent\");\n$RefreshReg$(_c29, \"PopupTitle\");\n$RefreshReg$(_c30, \"PopupDetail\");\n$RefreshReg$(_c31, \"FitAllStopsHandler\");\n$RefreshReg$(_c32, \"MapBoundsHandler\");\n$RefreshReg$(_c33, \"MapClickHandler\");\n$RefreshReg$(_c34, \"RouteMap\");","map":{"version":3,"names":["React","useState","useEffect","MapContainer","TileLayer","Marker","Polyline","Popup","useMap","L","styled","theme","RoutingService","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","createCustomIcon","color","divIcon","className","html","iconSize","iconAnchor","popupAnchor","defaultIcon","selectedIcon","tempIcon","MapWrapper","div","height","colors","border","borderRadius","lg","surface","card","textPrimary","cardHover","md","shadows","_c","MapSidebar","_c2","SidebarHeader","spacing","_c3","SidebarTitle","h3","typography","fontSize","fontWeight","semibold","sm","_c4","SidebarContent","_c5","ControlSection","_c6","ControlGroup","_c7","ToggleButton","button","active","primary","medium","surfaceHover","_c8","ActionButton","_c9","SearchSection","_c0","SearchContainer","_c1","SearchInput","input","textMuted","_c10","SearchDropdown","isOpen","_c11","DropdownItem","_c12","DropdownItemInfo","_c13","DropdownItemName","_c14","DropdownItemCode","textSecondary","xs","_c15","NoResults","_c16","SelectedStopsSection","_c17","SelectedStopsHeader","_c18","SelectedStopsList","_c19","SelectedStopItem","_c20","StopOrder","bold","_c21","StopInfo","_c22","StopName","_c23","StopCode","_c24","RemoveButton","error","_c25","EmptyState","xl","_c26","MapInfo","_c27","RouteInfo","RouteInfoItem","PopupContent","_c28","PopupTitle","h4","_c29","PopupDetail","_c30","FitAllStopsHandler","stops","_s","map","length","bounds","latLngBounds","stop","parseFloat","location","lat","toString","lon","fitBounds","padding","maxZoom","console","_c31","MapBoundsHandler","selectedStops","_s2","setView","_c32","MapClickHandler","onMapClick","isManualAddMode","_s3","log","hasCallback","handleClick","e","_e$latlng","_e$latlng2","latlng","lng","undefined","on","off","_c33","RouteMap","center","zoom","showRoute","onStopClick","onFitRoute","showAllStops","onToggleShowAllStops","searchTerm","onSearchChange","filteredStops","onAddStop","onRemoveStop","onToggleManualMode","tempMarker","_s4","defaultCenter","routeData","setRouteData","isCalculatingRoute","setIsCalculatingRoute","isSearchDropdownOpen","setIsSearchDropdownOpen","stopsCount","selectedStopsCount","stopsArray","slice","abortController","AbortController","timeoutId","waypoints","setTimeout","signal","aborted","route","calculateRoute","coordinates","distance","duration","abort","clearTimeout","routeCoordinates","coord","handleSearchChange","value","shouldOpen","handleSearchFocus","handleSearchBlur","handleDropdownItemClick","children","style","opacity","fileName","_jsxFileName","lineNumber","columnNumber","marginTop","onClick","type","placeholder","onChange","target","onFocus","onBlur","isSelected","some","s","id","selected","name","code","index","marginBottom","width","attribution","url","stopsLength","markers","selectedIndex","findIndex","position","icon","eventHandlers","click","filter","m","shouldRender","toFixed","positions","secondary","weight","dashArray","_c34","$RefreshReg$"],"sources":["/home/mhmdal/Projects/moveo-master/moveo/src/components/Map/RouteMap.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { MapContainer, TileLayer, Marker, Polyline, Popup, useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport styled from 'styled-components';\nimport { theme } from '../../styles/theme';\nimport { Stop } from '../../types';\nimport { RoutingService, RouteResponse, RouteCoordinate } from '../../services/routingService';\n\n// Fix for default markers in React Leaflet\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n});\n\n// Create custom colored markers\nconst createCustomIcon = (color: string) => {\n  return L.divIcon({\n    className: 'custom-marker',\n    html: `\n      <div style=\"\n        background-color: ${color};\n        width: 25px;\n        height: 25px;\n        border-radius: 50% 50% 50% 0;\n        border: 3px solid white;\n        transform: rotate(-45deg);\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      \">\n        <div style=\"\n          transform: rotate(45deg);\n          color: white;\n          font-weight: bold;\n          font-size: 12px;\n        \"></div>\n      </div>\n    `,\n    iconSize: [25, 25],\n    iconAnchor: [12, 24],\n    popupAnchor: [0, -24]\n  });\n};\n\n// Default blue marker for available stops\nconst defaultIcon = createCustomIcon('#3b82f6');\n\n// Green marker for selected stops in route\nconst selectedIcon = createCustomIcon('#10b981');\n\n// Red marker for temporary/pending stops\nconst tempIcon = createCustomIcon('#ef4444');\n\nconst MapWrapper = styled.div<{ height?: string }>`\n  width: 100%;\n  height: ${({ height }) => height || '500px'};\n  border: 2px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.lg};\n  overflow: hidden;\n  position: relative;\n  \n  .leaflet-container {\n    height: 100%;\n    width: 100%;\n    background: ${theme.colors.surface};\n  }\n  \n  .leaflet-control-container {\n    .leaflet-control-zoom {\n      background: ${theme.colors.card};\n      border: 1px solid ${theme.colors.border};\n      \n      a {\n        background: ${theme.colors.card};\n        color: ${theme.colors.textPrimary};\n        border-bottom: 1px solid ${theme.colors.border};\n        \n        &:hover {\n          background: ${theme.colors.cardHover};\n        }\n        \n        &:last-child {\n          border-bottom: none;\n        }\n      }\n    }\n    \n    .leaflet-control-attribution {\n      background: rgba(0, 0, 0, 0.8);\n      color: white;\n      font-size: 11px;\n      \n      a {\n        color: #3b82f6;\n      }\n    }\n  }\n  \n  .leaflet-popup-content-wrapper {\n    background: ${theme.colors.card};\n    color: ${theme.colors.textPrimary};\n    border-radius: ${theme.borderRadius.md};\n    box-shadow: ${theme.shadows.lg};\n  }\n  \n  .leaflet-popup-tip {\n    background: ${theme.colors.card};\n  }\n\n  /* Custom marker styles for interactive stops */\n  .leaflet-marker-icon {\n    cursor: pointer;\n    transition: transform 0.2s ease-in-out, filter 0.2s ease-in-out;\n    \n    &:hover {\n      transform: scale(1.1);\n      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));\n    }\n  }\n\n  /* Custom marker styling */\n  .custom-marker {\n    background: transparent !important;\n    border: none !important;\n  }\n`;\n\nconst MapSidebar = styled.div`\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 300px;\n  height: 100%;\n  background: ${theme.colors.card};\n  border-left: 1px solid ${theme.colors.border};\n  z-index: 1000;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst SidebarHeader = styled.div`\n  padding: ${theme.spacing.lg};\n  border-bottom: 1px solid ${theme.colors.border};\n  background: ${theme.colors.surface};\n`;\n\nconst SidebarTitle = styled.h3`\n  margin: 0;\n  font-size: ${theme.typography.fontSize.lg};\n  font-weight: ${theme.typography.fontWeight.semibold};\n  color: ${theme.colors.textPrimary};\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n`;\n\nconst SidebarContent = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst ControlSection = styled.div`\n  padding: ${theme.spacing.lg};\n  border-bottom: 1px solid ${theme.colors.border};\n`;\n\nconst ControlGroup = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: ${theme.spacing.md};\n`;\n\nconst ToggleButton = styled.button<{ active: boolean }>`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${({ active }) => active ? theme.colors.primary : theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${({ active }) => active ? theme.colors.primary : theme.colors.surface};\n  color: ${({ active }) => active ? 'white' : theme.colors.textPrimary};\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  \n  &:hover {\n    background: ${({ active }) => active ? theme.colors.primary : theme.colors.surfaceHover};\n    transform: translateY(-1px);\n  }\n`;\n\nconst ActionButton = styled.button`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${theme.colors.surface};\n  color: ${theme.colors.textPrimary};\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  \n  &:hover {\n    background: ${theme.colors.surfaceHover};\n    transform: translateY(-1px);\n  }\n  \n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n  }\n`;\n\nconst SearchSection = styled.div`\n  display: flex;\n  flex-direction: column;\n  overflow: visible;\n`;\n\nconst SearchContainer = styled.div`\n  position: relative;\n  padding: ${theme.spacing.lg} ${theme.spacing.lg} ${theme.spacing.md};\n  overflow: visible;\n`;\n\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${theme.colors.surface};\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n  transition: all 0.2s ease-in-out;\n  \n  &:focus {\n    outline: none;\n    border-color: ${theme.colors.primary};\n    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);\n  }\n  \n  &::placeholder {\n    color: ${theme.colors.textMuted};\n  }\n`;\n\nconst SearchDropdown = styled.div<{ isOpen: boolean }>`\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  border-top: none;\n  border-radius: 0 0 ${theme.borderRadius.md} ${theme.borderRadius.md};\n  box-shadow: ${theme.shadows.lg};\n  z-index: 1000;\n  max-height: 200px;\n  min-height: 40px;\n  overflow-y: auto;\n  display: ${({ isOpen }) => isOpen ? 'block' : 'none'};\n  transition: all 0.2s ease-in-out;\n`;\n\nconst DropdownItem = styled.div<{ selected?: boolean }>`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  border-bottom: 1px solid ${theme.colors.border};\n  \n  background: ${theme.colors.surface};\n    \n  &:hover {\n    background: ${theme.colors.surfaceHover};\n  }\n  \n  &:last-child {\n    border-bottom: none;\n  }\n`;\n\nconst DropdownItemInfo = styled.div`\n  flex: 1;\n  min-width: 0;\n`;\n\nconst DropdownItemName = styled.div`\n  font-weight: ${theme.typography.fontWeight.medium};\n  color: inherit;\n  font-size: ${theme.typography.fontSize.sm};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst DropdownItemCode = styled.div`\n  color: ${theme.colors.textSecondary};\n  font-size: ${theme.typography.fontSize.xs};\n  margin-top: ${theme.spacing.xs};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst NoResults = styled.div`\n  padding: ${theme.spacing.md};\n  text-align: center;\n  color: ${theme.colors.textMuted};\n  font-size: ${theme.typography.fontSize.sm};\n`;\n\nconst SelectedStopsSection = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst SelectedStopsHeader = styled.div`\n  padding: 0 ${theme.spacing.lg} ${theme.spacing.sm};\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  color: ${theme.colors.textSecondary};\n`;\n\nconst SelectedStopsList = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: ${theme.spacing.md} ${theme.spacing.lg};\n`;\n\nconst SelectedStopItem = styled.div`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  margin-bottom: ${theme.spacing.xs};\n  background: ${theme.colors.surface};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  transition: all 0.2s ease-in-out;\n  \n  &:hover {\n    background: ${theme.colors.surfaceHover};\n    transform: translateY(-1px);\n    box-shadow: ${theme.shadows.sm};\n  }\n`;\n\nconst StopOrder = styled.div`\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  background: ${theme.colors.primary};\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: ${theme.typography.fontWeight.bold};\n  font-size: ${theme.typography.fontSize.xs};\n  flex-shrink: 0;\n`;\n\nconst StopInfo = styled.div`\n  flex: 1;\n  min-width: 0;\n`;\n\nconst StopName = styled.div`\n  font-weight: ${theme.typography.fontWeight.medium};\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst StopCode = styled.div`\n  color: ${theme.colors.textSecondary};\n  font-size: ${theme.typography.fontSize.xs};\n  margin-top: ${theme.spacing.xs};\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst RemoveButton = styled.button`\n  color: ${theme.colors.error};\n  padding: ${theme.spacing.xs};\n  border-radius: ${theme.borderRadius.sm};\n  transition: all 0.2s ease-in-out;\n  \n  &:hover {\n    background: rgba(239, 68, 68, 0.1);\n    transform: scale(1.1);\n  }\n`;\n\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: ${theme.spacing.xl};\n  color: ${theme.colors.textMuted};\n`;\n\nconst MapInfo = styled.div`\n  position: absolute;\n  top: ${theme.spacing.md};\n  left: ${theme.spacing.md};\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border-radius: ${theme.borderRadius.md};\n  font-size: ${theme.typography.fontSize.sm};\n  z-index: 1000;\n  pointer-events: none;\n  max-width: 250px;\n`;\n\nconst RouteInfo = styled.div`\n  position: absolute;\n  top: ${theme.spacing.md};\n  right: ${theme.spacing.md};\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border-radius: ${theme.borderRadius.md};\n  font-size: ${theme.typography.fontSize.sm};\n  z-index: 1000;\n  pointer-events: none;\n  min-width: 150px;\n`;\n\nconst RouteInfoItem = styled.div`\n  margin: 2px 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n`;\n\nconst PopupContent = styled.div`\n  min-width: 200px;\n`;\n\nconst PopupTitle = styled.h4`\n  margin: 0 0 ${theme.spacing.sm} 0;\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n`;\n\nconst PopupDetail = styled.div`\n  margin: ${theme.spacing.xs} 0;\n  font-size: ${theme.typography.fontSize.xs};\n  color: ${theme.colors.textSecondary};\n`;\n\n// Component to fit all available stops into view\nconst FitAllStopsHandler: React.FC<{ stops: Stop[] }> = ({ stops }) => {\n  const map = useMap();\n\n  useEffect(() => {\n    if (stops.length === 0) return;\n\n    try {\n      // Create bounds from all stops - convert string coords to numbers\n      const bounds = L.latLngBounds(\n        stops.map(stop => [parseFloat(stop.location.lat.toString()), parseFloat(stop.location.lon.toString())])\n      );\n\n      // Fit the map to show all stops\n      map.fitBounds(bounds, {\n        padding: [50, 50],\n        maxZoom: 16\n      });\n    } catch (error) {\n      console.error('Error fitting stops to view:', error);\n    }\n  }, [map, stops.length]);\n\n  return null;\n};\n\n// Component to handle map bounds fitting\nconst MapBoundsHandler: React.FC<{ selectedStops: Stop[] }> = ({ selectedStops }) => {\n  const map = useMap();\n\n  useEffect(() => {\n    if (selectedStops.length > 0) {\n      // Create bounds from selected stops - convert string coords to numbers\n      const bounds = L.latLngBounds(\n        selectedStops.map(stop => [parseFloat(stop.location.lat.toString()), parseFloat(stop.location.lon.toString())])\n      );\n\n      // Fit the map to show all selected stops with some padding\n      if (selectedStops.length === 1) {\n        // For single stop, just center on it with a reasonable zoom\n        const lat = parseFloat(selectedStops[0].location.lat.toString());\n        const lon = parseFloat(selectedStops[0].location.lon.toString());\n        map.setView([lat, lon], 14);\n      } else {\n        // For multiple stops, fit bounds with padding\n        map.fitBounds(bounds, { \n          padding: [20, 20],\n          maxZoom: 16 \n        });\n      }\n    }\n  }, [map, selectedStops]);\n\n  return null;\n};\n\n// Component to handle map clicks for manual stop addition\nconst MapClickHandler: React.FC<{ onMapClick?: (lat: number, lon: number) => void; isManualAddMode?: boolean }> = ({ \n  onMapClick, \n  isManualAddMode = false \n}) => {\n  const map = useMap();\n\n  useEffect(() => {\n    console.log('ðŸ–±ï¸ MapClickHandler Setup:', { isManualAddMode, hasCallback: !!onMapClick });\n    \n    if (!isManualAddMode || !onMapClick) {\n      console.log('â­ï¸ MapClickHandler - mode disabled or no callback');\n      return;\n    }\n\n    const handleClick = (e: any) => {\n      console.log('ðŸŽ¯ MAP CLICKED event:', e);\n      const lat = e.latlng?.lat;\n      const lng = e.latlng?.lng;\n      console.log('ðŸŽ¯ MAP CLICKED at:', { lat, lng, isManualAddMode });\n      if (lat !== undefined && lng !== undefined) {\n        onMapClick(lat, lng);\n      }\n    };\n\n    console.log('âœ… Attaching click handler to map');\n    \n    // Try both methods\n    map.on('click', handleClick);\n    \n    return () => {\n      console.log('âŒ Detaching click handler');\n      map.off('click', handleClick);\n    };\n  }, [map, onMapClick, isManualAddMode]);\n\n  return null;\n};\n\ninterface RouteMapProps {\n  stops: Stop[];\n  selectedStops: Stop[];\n  center?: { lat: number; lng: number };\n  zoom?: number;\n  showRoute?: boolean;\n  height?: string;\n  onStopClick?: (stop: Stop) => void;\n  onFitRoute?: () => void;\n  showAllStops?: boolean;\n  onToggleShowAllStops?: () => void;\n  searchTerm?: string;\n  onSearchChange?: (term: string) => void;\n  filteredStops?: Stop[];\n  onAddStop?: (stop: Stop) => void;\n  onRemoveStop?: (stopId: string) => void;\n  onMapClick?: (lat: number, lon: number) => void;\n  isManualAddMode?: boolean;\n  onToggleManualMode?: () => void;\n  tempMarker?: { lat: number; lon: number } | null;\n}\n\nconst RouteMap: React.FC<RouteMapProps> = ({ \n  stops,\n  selectedStops,\n  center,\n  zoom = 12,\n  showRoute = true,\n  height,\n  onStopClick,\n  onFitRoute,\n  showAllStops = true,\n  onToggleShowAllStops,\n  searchTerm = '',\n  onSearchChange,\n  filteredStops = [],\n  onAddStop,\n  onRemoveStop,\n  onMapClick,\n  isManualAddMode = false,\n  onToggleManualMode,\n  tempMarker\n}) => {\n  // Default center - Qatar (Doha) if no center provided\n  const defaultCenter = center || { lat: 25.2854, lng: 51.5310 };\n  \n  // State for route data\n  const [routeData, setRouteData] = useState<RouteResponse | null>(null);\n  const [isCalculatingRoute, setIsCalculatingRoute] = useState(false);\n  const [isSearchDropdownOpen, setIsSearchDropdownOpen] = useState(false);\n\n  // Debug: Log stops and manual mode\n  useEffect(() => {\n    console.log('RouteMap Debug:', {\n      stopsCount: stops.length,\n      selectedStopsCount: selectedStops.length,\n      isManualAddMode,\n      showAllStops,\n      defaultCenter,\n      stopsArray: stops.slice(0, 3) // First 3 stops\n    });\n  }, [stops.length, selectedStops.length, isManualAddMode, showAllStops, defaultCenter]);\n\n  // Calculate route when selected stops change\n  useEffect(() => {\n    // Create an AbortController for this effect\n    const abortController = new AbortController();\n    let timeoutId: NodeJS.Timeout;\n\n    if (selectedStops.length >= 2 && showRoute) {\n      setIsCalculatingRoute(true);\n      \n      const waypoints: RouteCoordinate[] = selectedStops.map(stop => ({\n        lat: parseFloat(stop.location.lat.toString()),\n        lng: parseFloat(stop.location.lon.toString())\n      }));\n\n      // Create a stable key for this route calculation\n    //   const routeKey = waypoints.map(w => `${w.lat.toFixed(6)},${w.lng.toFixed(6)}`).join('|');\n      \n      // Add a longer delay to avoid excessive API calls during hot reload\n      timeoutId = setTimeout(async () => {\n        // Check if component is still mounted and request not aborted\n        if (abortController.signal.aborted) {\n          return;\n        }\n\n        try {\n          const route = await RoutingService.calculateRoute(waypoints, abortController.signal);\n          \n          // Check again if component is still mounted\n          if (!abortController.signal.aborted) {\n            setRouteData(route);\n            setIsCalculatingRoute(false);\n          }\n        } catch (error) {\n          // Only handle error if not aborted\n          if (!abortController.signal.aborted) {\n            console.error('Failed to calculate route:', error);\n            setIsCalculatingRoute(false);\n            // Fallback to straight line\n            setRouteData({\n              coordinates: waypoints,\n              distance: 0,\n              duration: 0\n            });\n          }\n        }\n      }, 1000); // Increased to 1 second to reduce hot reload requests\n\n    } else {\n      setRouteData(null);\n      setIsCalculatingRoute(false);\n    }\n\n    // Cleanup function\n    return () => {\n      abortController.abort();\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n    };\n  }, [selectedStops, showRoute]);\n\n  // Create route line coordinates for Leaflet Polyline\n  const routeCoordinates: [number, number][] = routeData \n    ? routeData.coordinates.map(coord => [coord.lat, coord.lng])\n    : selectedStops.map(stop => [stop.location.lat, stop.location.lon]);\n\n  // Search handlers\n  const handleSearchChange = (value: string) => {\n    onSearchChange?.(value);\n    const shouldOpen = value.length > 0;\n    console.log('Search change:', value, 'Should open:', shouldOpen, 'Filtered stops:', filteredStops.length);\n    setIsSearchDropdownOpen(shouldOpen);\n  };\n\n  const handleSearchFocus = () => {\n    console.log('Search focus, searchTerm:', searchTerm, 'length:', searchTerm.length);\n    if (searchTerm.length > 0) {\n      setIsSearchDropdownOpen(true);\n    }\n  };\n\n  const handleSearchBlur = () => {\n    // Delay closing to allow for click on dropdown item\n    setTimeout(() => {\n      setIsSearchDropdownOpen(false);\n    }, 200);\n  };\n\n  const handleDropdownItemClick = (stop: Stop) => {\n    onAddStop?.(stop);\n    onSearchChange?.('');\n    setIsSearchDropdownOpen(false);\n  };\n\n  return (\n    <MapWrapper>\n      {onStopClick && (\n        <MapInfo>\n          <div style={{ fontSize: '12px', opacity: 0.8 }}>\n            ðŸ“ Click stops to add to route\n          </div>\n          {isCalculatingRoute && (\n            <div style={{ marginTop: '4px', fontSize: '12px', opacity: 0.8, color: '#3b82f6' }}>\n              ðŸ›£ï¸ Calculating road route...\n            </div>\n          )}\n          {selectedStops.length === 1 && (\n            <div style={{ marginTop: '4px', fontSize: '12px', opacity: 0.8 }}>\n              Add another stop to see route\n            </div>\n          )}\n        </MapInfo>\n      )}\n      \n      \n      {/* Map Sidebar */}\n      <MapSidebar>\n        <SidebarHeader>\n          <SidebarTitle>\n            ðŸ—ºï¸ Route Builder\n          </SidebarTitle>\n        </SidebarHeader>\n        \n        <SidebarContent>\n          {/* Controls Section */}\n          <ControlSection>\n            <ControlGroup>\n              {onToggleShowAllStops && (\n                <ToggleButton\n                  active={showAllStops}\n                  onClick={onToggleShowAllStops}\n                >\n                  ðŸ“ {showAllStops ? 'Hide All Stops' : 'Show All Stops'}\n                </ToggleButton>\n              )}\n              \n              {onToggleManualMode && (\n                <ToggleButton\n                  active={isManualAddMode}\n                  onClick={onToggleManualMode}\n                >\n                  ðŸ“Œ {isManualAddMode ? 'Stop Placement Mode' : 'Click to Add Stops'}\n                </ToggleButton>\n              )}\n              \n              {selectedStops.length >= 2 && onFitRoute && (\n                <ActionButton onClick={onFitRoute}>\n                  ðŸŽ¯ Fit Route to View\n                </ActionButton>\n              )}\n            </ControlGroup>\n          </ControlSection>\n          \n          {/* Search Section */}\n          <SearchSection>\n            <SearchContainer>\n              <SearchInput\n                type=\"text\"\n                placeholder=\"Search stops to add...\"\n                value={searchTerm}\n                onChange={(e) => handleSearchChange(e.target.value)}\n                onFocus={handleSearchFocus}\n                onBlur={handleSearchBlur}\n              />\n              \n              {/* Search Dropdown */}\n              <SearchDropdown isOpen={isSearchDropdownOpen}>\n                {filteredStops.length > 0 ? (\n                  filteredStops.map((stop) => {\n                    const isSelected = selectedStops.some(s => s.id === stop.id);\n                    return (\n                      <DropdownItem\n                        key={stop.id}\n                        selected={isSelected}\n                        onClick={() => !isSelected && handleDropdownItemClick(stop)}\n                      >\n                        <DropdownItemInfo>\n                          <DropdownItemName>{stop.name}</DropdownItemName>\n                          <DropdownItemCode>{stop.code}</DropdownItemCode>\n                        </DropdownItemInfo>\n                        {!isSelected && (\n                          <div style={{ color: theme.colors.primary, fontSize: '16px' }}>+</div>\n                        )}\n                      </DropdownItem>\n                    );\n                  })\n                ) : (\n                  <NoResults>\n                    No stops found for \"{searchTerm}\"\n                  </NoResults>\n                )}\n              </SearchDropdown>\n            </SearchContainer>\n          </SearchSection>\n          \n          {/* Selected Stops Section */}\n          <SelectedStopsSection>\n            <SelectedStopsHeader>\n              Selected Stops ({selectedStops.length})\n            </SelectedStopsHeader>\n            \n            <SelectedStopsList>\n              {selectedStops.length > 0 ? (\n                selectedStops.map((stop, index) => (\n                  <SelectedStopItem key={stop.id}>\n                    <StopOrder>{index + 1}</StopOrder>\n                    <StopInfo>\n                      <StopName>{stop.name}</StopName>\n                      <StopCode>{stop.code}</StopCode>\n                    </StopInfo>\n                    <RemoveButton onClick={() => onRemoveStop?.(stop.id)}>\n                      Ã—\n                    </RemoveButton>\n                  </SelectedStopItem>\n                ))\n              ) : (\n                <EmptyState>\n                  <div style={{ fontSize: '20px', marginBottom: '8px' }}>ðŸ“</div>\n                  <div style={{ fontSize: '12px', fontWeight: '500' }}>No stops selected</div>\n                  <div style={{ fontSize: '10px', marginTop: '4px', color: theme.colors.textMuted }}>\n                    Search and add stops to build your route\n                  </div>\n                </EmptyState>\n              )}\n            </SelectedStopsList>\n          </SelectedStopsSection>\n        </SidebarContent>\n      </MapSidebar>\n      \n      <MapContainer\n        center={[defaultCenter.lat, defaultCenter.lng]}\n        zoom={zoom}\n        style={{ height: '100%', width: '100%' }}\n      >\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        \n        {/* Handle automatic bounds fitting when stops change */}\n        <MapBoundsHandler selectedStops={selectedStops} />\n        {/* Handle fitting all stops into view when they load */}\n        <FitAllStopsHandler stops={stops} />\n        \n        {/* Handle map clicks for manual stop addition */}\n        <MapClickHandler onMapClick={onMapClick} isManualAddMode={isManualAddMode} />\n        \n        {/* Show all available stops */}\n        {(() => {\n          console.log('ðŸ—ºï¸ MAP RENDERING:', { stopsLength: stops.length, showAllStops });\n          const markers = stops.map((stop) => {\n            const isSelected = selectedStops.some(s => s.id === stop.id);\n            const selectedIndex = selectedStops.findIndex(s => s.id === stop.id);\n            \n            // Only show non-selected stops if showAllStops is true\n            if (!isSelected && !showAllStops) {\n              console.log('â­ï¸ SKIPPING STOP:', stop.name, '(not selected & showAllStops is false)');\n              return null;\n            }\n            \n            const lat = parseFloat(stop.location.lat.toString());\n            const lon = parseFloat(stop.location.lon.toString());\n            \n            console.log('ðŸ“ MARKER RENDER:', {\n              name: stop.name,\n              lat,\n              lon,\n              isSelected\n            });\n            \n            return (\n              <Marker\n                key={stop.id}\n                position={[lat, lon]}\n                icon={isSelected ? selectedIcon : defaultIcon}\n                eventHandlers={{\n                  click: () => {\n                    if (onStopClick) {\n                      onStopClick(stop);\n                    }\n                  }\n                }}\n              >\n                <Popup>\n                  <PopupContent>\n                    <PopupTitle>{stop.name}</PopupTitle>\n                    <PopupDetail><strong>Code:</strong> {stop.code}</PopupDetail>\n                    {isSelected && (\n                      <PopupDetail><strong>Order:</strong> #{selectedIndex + 1} in route</PopupDetail>\n                    )}\n                    {onStopClick && !isSelected && (\n                      <PopupDetail style={{ color: theme.colors.primary, fontWeight: 'bold', marginTop: '8px' }}>\n                        Click to add to route\n                      </PopupDetail>\n                    )}\n                  </PopupContent>\n                </Popup>\n              </Marker>\n            );\n          });\n          console.log('ðŸŽ¨ TOTAL MARKERS RENDERED:', markers.filter(m => m !== null).length);\n          return markers;\n        })()}\n        \n        {/* Show temporary marker when adding stop manually */}\n        {(() => {\n          console.log('ðŸ”´ TEMP MARKER CHECK:', {\n            tempMarker,\n            isManualAddMode,\n            shouldRender: tempMarker && isManualAddMode\n          });\n          \n          if (tempMarker && isManualAddMode) {\n            const lat = parseFloat(tempMarker.lat.toString());\n            const lon = parseFloat(tempMarker.lon.toString());\n            \n            console.log('ðŸ”´ RENDERING TEMP MARKER at:', { lat, lon });\n            \n            return (\n              <Marker\n                position={[lat, lon]}\n                icon={tempIcon}\n              >\n                <Popup>\n                  <PopupContent>\n                    <PopupTitle>New Stop Location</PopupTitle>\n                    <PopupDetail><strong>Lat:</strong> {lat.toFixed(6)}</PopupDetail>\n                    <PopupDetail><strong>Lon:</strong> {lon.toFixed(6)}</PopupDetail>\n                  </PopupContent>\n                </Popup>\n              </Marker>\n            );\n          }\n          return null;\n        })()}\n        \n        {/* Show route line */}\n        {showRoute && selectedStops.length > 1 && routeCoordinates.length > 0 && (\n          <Polyline\n            positions={routeCoordinates}\n            color={routeData ? theme.colors.primary : theme.colors.secondary}\n            weight={routeData ? 5 : 4}\n            opacity={routeData ? 0.9 : 0.6}\n            dashArray={routeData ? undefined : \"10, 5\"}\n          />\n        )}\n      </MapContainer>\n    </MapWrapper>\n  );\n};\n\nexport default RouteMap;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}