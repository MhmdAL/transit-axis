{"ast":null,"code":"import _objectSpread from\"/home/mhmdal/Projects/moveo-master/moveo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _taggedTemplateLiteral from\"/home/mhmdal/Projects/moveo-master/moveo/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0,_templateObject1,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14;import React,{useState,useMemo,useEffect}from'react';import{useNavigate,useParams}from'react-router-dom';import{FiArrowLeft,FiX,FiCopy,FiEye}from'react-icons/fi';import styled from'styled-components';import{Button}from'../../styles/GlobalStyles';import{theme}from'../../styles/theme';import{PageContainer,PageHeader,PageTitle,HeaderActions,FormCard,FormGrid,FormGroup,Label,Input,ErrorMessage}from'../../components/Common/CommonStyles';import{apiService}from'../../services/apiService';import TripTemplateManager from'../../components/Forms/TripTemplateManager';import MultiSelectSearchDropdown from'../../components/UI/DropDowns/MultiSelectSearchDropdown';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const CodesContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  background: \",\";\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  padding: \",\";\\n  margin-bottom: \",\";\\n\"])),theme.colors.card,theme.colors.border,theme.borderRadius.lg,theme.spacing.lg,theme.spacing.lg);const CodesGrid=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: 1fr 1fr;\\n  gap: \",\";\\n  \\n  @media (max-width: 768px) {\\n    grid-template-columns: 1fr;\\n  }\\n\"])),theme.spacing.xl);const CodeColumn=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n\"])));const CodeColumnHeader=styled.h3(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  color: \",\";\\n  margin: 0 0 \",\" 0;\\n  font-size: \",\";\\n  font-weight: \",\";\\n\"])),theme.colors.textPrimary,theme.spacing.md,theme.typography.fontSize.lg,theme.typography.fontWeight.semibold);const CodeAddForm=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: \",\";\\n  align-items: center;\\n  margin-bottom: \",\";\\n  padding-bottom: \",\";\\n  border-bottom: 1px solid \",\";\\n\"])),theme.spacing.xs,theme.spacing.md,theme.spacing.md,theme.colors.border);const CodeInput=styled.input(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  background: \",\";\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  padding: \",\" \",\";\\n  font-size: \",\";\\n  font-family: monospace;\\n  color: \",\";\\n  \\n  &:focus {\\n    outline: none;\\n    border-color: \",\";\\n  }\\n\"])),theme.colors.surface,theme.colors.border,theme.borderRadius.sm,theme.spacing.xs,theme.spacing.sm,theme.typography.fontSize.sm,theme.colors.textPrimary,theme.colors.primary);const AddButton=styled.button(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  background: \",\";\\n  color: white;\\n  border: none;\\n  padding: \",\" \",\";\\n  border-radius: \",\";\\n  font-size: \",\";\\n  cursor: pointer;\\n  transition: all 0.2s ease;\\n  white-space: nowrap;\\n\\n  &:hover {\\n    background: \",\";\\n  }\\n  \\n  &:disabled {\\n    opacity: 0.5;\\n    cursor: not-allowed;\\n  }\\n\"])),theme.colors.primary,theme.spacing.xs,theme.spacing.md,theme.borderRadius.sm,theme.typography.fontSize.sm,theme.colors.primaryHover);const CodeList=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  gap: \",\";\\n\"])),theme.spacing.xs);const CodeRow=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n  padding: \",\";\\n  background: \",\";\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  transition: all 0.2s ease;\\n\\n  &:hover {\\n    background: \",\";\\n    border-color: \",\";\\n  }\\n\"])),theme.spacing.sm,theme.spacing.sm,theme.colors.surface,theme.colors.border,theme.borderRadius.sm,theme.colors.surfaceHover,theme.colors.primary);const ColorIndicator=styled.div(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"\\n  width: 20px;\\n  height: 20px;\\n  border-radius: 4px;\\n  background-color: \",\";\\n  border: 1px solid \",\";\\n  flex-shrink: 0;\\n\"])),props=>props.color,theme.colors.border);const CodeText=styled.span(_templateObject1||(_templateObject1=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  font-family: monospace;\\n  font-size: \",\";\\n  color: \",\";\\n  font-weight: \",\";\\n\"])),theme.typography.fontSize.sm,theme.colors.textPrimary,theme.typography.fontWeight.medium);const DeleteButton=styled.button(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  background: transparent;\\n  border: none;\\n  color: \",\";\\n  cursor: pointer;\\n  padding: \",\";\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  border-radius: \",\";\\n  transition: all 0.2s ease;\\n  flex-shrink: 0;\\n  \\n  &:hover {\\n    color: \",\";\\n    background: \",\"10;\\n  }\\n\"])),theme.colors.textSecondary,theme.spacing.xs,theme.borderRadius.sm,theme.colors.error,theme.colors.error);const EmptyState=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  padding: \",\";\\n  text-align: center;\\n  color: \",\";\\n  font-style: italic;\\n  font-size: \",\";\\n\"])),theme.spacing.md,theme.colors.textMuted,theme.typography.fontSize.sm);const CloneSection=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  background: \",\";\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  padding: \",\";\\n  margin-bottom: \",\";\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n\"])),theme.colors.surface,theme.colors.border,theme.borderRadius.lg,theme.spacing.lg,theme.spacing.lg,theme.spacing.md);const CloneLabel=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n  color: \",\";\\n  font-weight: \",\";\\n  white-space: nowrap;\\n  min-width: 180px;\\n\"])),theme.spacing.sm,theme.colors.textPrimary,theme.typography.fontWeight.medium);const CloneDropdownWrapper=styled.div(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  flex: 1;\\n\"])));// Generate a random vibrant color\nconst generateRandomColor=()=>{// Generate HSL color with high saturation and medium lightness for vibrant colors\nconst hue=Math.floor(Math.random()*360);const saturation=65+Math.floor(Math.random()*20);// 65-85%\nconst lightness=45+Math.floor(Math.random()*15);// 45-60%\nreturn\"hsl(\".concat(hue,\", \").concat(saturation,\"%, \").concat(lightness,\"%)\");};const CreateServiceSchedule=()=>{const navigate=useNavigate();const{id}=useParams();const isViewMode=window.location.pathname.includes('/view/');const[formData,setFormData]=useState({name:''});const[errors,setErrors]=useState({});const[isSubmitting,setIsSubmitting]=useState(false);const[isLoading,setIsLoading]=useState(false);const[dutyTemplates,setDutyTemplates]=useState([]);const[templateError,setTemplateError]=useState(null);const[vehicleBlockCodes,setVehicleBlockCodes]=useState([]);const[driverRunCodes,setDriverRunCodes]=useState([]);const[newBlockCode,setNewBlockCode]=useState('');const[newRunCode,setNewRunCode]=useState('');// Clone functionality (only in create mode)\nconst[selectedCloneSchedule,setSelectedCloneSchedule]=useState([]);// Load schedule data in view mode\nuseEffect(()=>{if(isViewMode&&id){loadScheduleForViewing(id);}},[isViewMode,id]);const searchSchedules=async searchTerm=>{try{if(!searchTerm.trim()){// Load all schedules when dropdown is opened\nreturn await apiService.getServiceSchedules();}const allSchedules=await apiService.getServiceSchedules();return allSchedules.filter(schedule=>schedule.name.toLowerCase().includes(searchTerm.toLowerCase()));}catch(error){console.error('Error searching schedules:',error);return[];}};const handleCloneScheduleChange=schedules=>{// Only allow single selection\nif(schedules.length>0){const selectedSchedule=schedules[schedules.length-1];setSelectedCloneSchedule([selectedSchedule]);handleCloneSelect(selectedSchedule.id);}else{setSelectedCloneSchedule([]);handleCloneSelect('');}};const loadScheduleForViewing=async scheduleId=>{try{setIsLoading(true);const schedule=await apiService.getServiceScheduleById(scheduleId);// Set form data without modification for viewing\nsetFormData({name:schedule.name});// Load vehicle block templates and create a map of id -> code\nconst vehicleBlockTemplates=schedule.vehicleBlockTemplates||[];const vehicleBlocks=vehicleBlockTemplates.map(block=>({code:block.code,color:block.color}));setVehicleBlockCodes(vehicleBlocks);const blockIdToCodeMap=new Map();vehicleBlockTemplates.forEach(block=>{blockIdToCodeMap.set(block.id,block.code);});// Load driver run templates and create a map of id -> code\nconst driverRunTemplates=schedule.driverRunTemplates||[];const driverRuns=driverRunTemplates.map(run=>({code:run.code,color:run.color}));setDriverRunCodes(driverRuns);const runIdToCodeMap=new Map();driverRunTemplates.forEach(run=>{runIdToCodeMap.set(run.id,run.code);});// Load duty templates and map their block/run IDs to codes\nif(schedule.dutyTemplates){const mappedTemplates=schedule.dutyTemplates.map(template=>_objectSpread(_objectSpread({},template),{},{vehicleBlockCode:template.vehicleBlockTemplateId?blockIdToCodeMap.get(template.vehicleBlockTemplateId):undefined,driverRunCode:template.driverRunTemplateId?runIdToCodeMap.get(template.driverRunTemplateId):undefined}));setDutyTemplates(mappedTemplates);}}catch(error){console.error('Error loading schedule:',error);alert('Failed to load schedule. Please try again.');navigate('/service-schedules');}finally{setIsLoading(false);}};const handleCloneSelect=async scheduleId=>{if(!scheduleId){// Clear form if deselected\nsetFormData({name:''});setVehicleBlockCodes([]);setDriverRunCodes([]);setDutyTemplates([]);return;}try{const schedule=await apiService.getServiceScheduleById(scheduleId);// Set form data with a modified name for cloning\nsetFormData({name:\"\".concat(schedule.name,\" (Copy)\")});// Load vehicle block templates and create a map of id -> code\nconst vehicleBlockTemplates=schedule.vehicleBlockTemplates||[];const vehicleBlocks=vehicleBlockTemplates.map(block=>({code:block.code,color:block.color}));setVehicleBlockCodes(vehicleBlocks);const blockIdToCodeMap=new Map();vehicleBlockTemplates.forEach(block=>{blockIdToCodeMap.set(block.id,block.code);});// Load driver run templates and create a map of id -> code\nconst driverRunTemplates=schedule.driverRunTemplates||[];const driverRuns=driverRunTemplates.map(run=>({code:run.code,color:run.color}));setDriverRunCodes(driverRuns);const runIdToCodeMap=new Map();driverRunTemplates.forEach(run=>{runIdToCodeMap.set(run.id,run.code);});// Load duty templates and map their block/run IDs to codes\nif(schedule.dutyTemplates){const mappedTemplates=schedule.dutyTemplates.map(template=>_objectSpread(_objectSpread({},template),{},{vehicleBlockCode:template.vehicleBlockTemplateId?blockIdToCodeMap.get(template.vehicleBlockTemplateId):undefined,driverRunCode:template.driverRunTemplateId?runIdToCodeMap.get(template.driverRunTemplateId):undefined}));setDutyTemplates(mappedTemplates);}}catch(error){console.error('Error loading schedule for cloning:',error);alert('Failed to load schedule for cloning. Please try again.');}};// Sync codes from templates\nuseMemo(()=>{const blockCodes=new Set();const runCodes=new Set();dutyTemplates.forEach(t=>{if(t.vehicleBlockCode)blockCodes.add(t.vehicleBlockCode);if(t.driverRunCode)runCodes.add(t.driverRunCode);});// Add codes from templates that aren't in state yet\nconst currentBlockCodes=new Set(vehicleBlockCodes.map(c=>c.code));const currentRunCodes=new Set(driverRunCodes.map(c=>c.code));const newBlockCodes=Array.from(blockCodes).filter(c=>!currentBlockCodes.has(c));const newRunCodes=Array.from(runCodes).filter(c=>!currentRunCodes.has(c));if(newBlockCodes.length>0){setVehicleBlockCodes(prev=>[...prev,...newBlockCodes.map(code=>({code,color:generateRandomColor()}))]);}if(newRunCodes.length>0){setDriverRunCodes(prev=>[...prev,...newRunCodes.map(code=>({code,color:generateRandomColor()}))]);}},[dutyTemplates]);const handleAddBlockCode=()=>{const code=newBlockCode.trim();if(code&&!vehicleBlockCodes.find(c=>c.code===code)){const color=generateRandomColor();setVehicleBlockCodes([...vehicleBlockCodes,{code,color}]);setNewBlockCode('');}};const handleRemoveBlockCode=code=>{setVehicleBlockCodes(vehicleBlockCodes.filter(c=>c.code!==code));// Remove code from templates\nsetDutyTemplates(templates=>templates.map(t=>t.vehicleBlockCode===code?_objectSpread(_objectSpread({},t),{},{vehicleBlockCode:undefined}):t));};const handleAddRunCode=()=>{const code=newRunCode.trim();if(code&&!driverRunCodes.find(c=>c.code===code)){const color=generateRandomColor();setDriverRunCodes([...driverRunCodes,{code,color}]);setNewRunCode('');}};const handleRemoveRunCode=code=>{setDriverRunCodes(driverRunCodes.filter(c=>c.code!==code));// Remove code from templates\nsetDutyTemplates(templates=>templates.map(t=>t.driverRunCode===code?_objectSpread(_objectSpread({},t),{},{driverRunCode:undefined}):t));};const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));// Clear error when user starts typing\nif(errors[name]){setErrors(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:undefined}));}};const validateForm=()=>{const newErrors={};if(!formData.name.trim()){newErrors.name='Schedule name is required';}setErrors(newErrors);return Object.keys(newErrors).length===0;};const handleSubmit=async e=>{e.preventDefault();if(!validateForm()){return;}setIsSubmitting(true);try{const scheduleData={name:formData.name,vehicleBlockCodes:vehicleBlockCodes.map(block=>({code:block.code,color:block.color})),driverRunCodes:driverRunCodes.map(run=>({code:run.code,color:run.color})),dutyTemplates:dutyTemplates.map(template=>({// Only send the fields needed for creation - NO IDs\nstartTime:template.startTime.split('T')[1].substring(0,5),// Extract HH:MM\nendTime:template.endTime.split('T')[1].substring(0,5),// Extract HH:MM\ndutyType:template.dutyType,// Only send codes, let backend create new associations\nvehicleBlockCode:template.vehicleBlockCode,driverRunCode:template.driverRunCode// Explicitly NOT sending: id, vehicleBlockTemplateId, driverRunTemplateId, scheduleId\n}))};await apiService.createServiceSchedule(scheduleData);navigate('/service-schedules');}catch(error){console.error('Error creating service schedule:',error);alert('Failed to create service schedule. Please try again.');}finally{setIsSubmitting(false);}};const handleCancel=()=>{navigate('/service-schedules');};if(isLoading){return/*#__PURE__*/_jsx(PageContainer,{className:\"fade-in\",children:/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px'},children:\"Loading schedule...\"})});}return/*#__PURE__*/_jsxs(PageContainer,{className:\"fade-in\",children:[/*#__PURE__*/_jsxs(PageHeader,{children:[/*#__PURE__*/_jsx(PageTitle,{children:isViewMode?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FiEye,{style:{marginRight:'8px'}}),\"View Service Schedule\"]}):'Create Service Schedule'}),/*#__PURE__*/_jsxs(HeaderActions,{children:[/*#__PURE__*/_jsxs(Button,{variant:\"secondary\",onClick:handleCancel,children:[/*#__PURE__*/_jsx(FiArrowLeft,{style:{marginRight:'8px'}}),\"Back to List\"]}),!isViewMode&&/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:handleSubmit,disabled:isSubmitting,children:isSubmitting?'Creating...':'Create Schedule'})]})]}),!isViewMode&&/*#__PURE__*/_jsxs(CloneSection,{children:[/*#__PURE__*/_jsxs(CloneLabel,{children:[/*#__PURE__*/_jsx(FiCopy,{size:18}),\"Clone from existing:\"]}),/*#__PURE__*/_jsx(CloneDropdownWrapper,{children:/*#__PURE__*/_jsx(MultiSelectSearchDropdown,{values:selectedCloneSchedule,onChange:handleCloneScheduleChange,onSearch:searchSchedules,displayValue:schedule=>schedule.name,renderItem:schedule=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'4px 0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'500',fontSize:'14px'},children:schedule.name}),schedule.dutyTemplateCount!==undefined&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#6b7280',marginTop:'2px'},children:[schedule.dutyTemplateCount,\" templates \\u2022 \",schedule.vehicleBlockCount||0,\" blocks \\u2022 \",schedule.driverRunCount||0,\" runs\"]})]}),placeholder:\"Search or select a schedule to clone...\",minSearchLength:0,searchPromptMessage:\"Start typing to search or see all schedules\"})})]}),/*#__PURE__*/_jsx(FormCard,{children:/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(FormGrid,{children:/*#__PURE__*/_jsxs(FormGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"name\",children:\"Schedule Name *\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",id:\"name\",name:\"name\",value:formData.name,onChange:handleInputChange,placeholder:\"Enter schedule name\",hasError:!!errors.name,disabled:isViewMode,readOnly:isViewMode}),errors.name&&/*#__PURE__*/_jsx(ErrorMessage,{children:errors.name})]})})})}),/*#__PURE__*/_jsx(CodesContainer,{children:/*#__PURE__*/_jsxs(CodesGrid,{children:[/*#__PURE__*/_jsxs(CodeColumn,{children:[/*#__PURE__*/_jsx(CodeColumnHeader,{children:\"Vehicle Blocks\"}),!isViewMode&&/*#__PURE__*/_jsxs(CodeAddForm,{children:[/*#__PURE__*/_jsx(CodeInput,{value:newBlockCode,onChange:e=>setNewBlockCode(e.target.value),onKeyDown:e=>e.key==='Enter'&&handleAddBlockCode(),placeholder:\"Enter block code\"}),/*#__PURE__*/_jsx(AddButton,{onClick:handleAddBlockCode,disabled:!newBlockCode.trim(),children:\"Add\"})]}),/*#__PURE__*/_jsx(CodeList,{children:vehicleBlockCodes.length===0?/*#__PURE__*/_jsx(EmptyState,{children:\"No block codes added yet\"}):vehicleBlockCodes.map(codeColor=>/*#__PURE__*/_jsxs(CodeRow,{children:[/*#__PURE__*/_jsx(ColorIndicator,{color:codeColor.color}),/*#__PURE__*/_jsx(CodeText,{children:codeColor.code}),!isViewMode&&/*#__PURE__*/_jsx(DeleteButton,{onClick:()=>handleRemoveBlockCode(codeColor.code),title:\"Remove\",children:/*#__PURE__*/_jsx(FiX,{size:16})})]},codeColor.code))})]}),/*#__PURE__*/_jsxs(CodeColumn,{children:[/*#__PURE__*/_jsx(CodeColumnHeader,{children:\"Driver Runs\"}),!isViewMode&&/*#__PURE__*/_jsxs(CodeAddForm,{children:[/*#__PURE__*/_jsx(CodeInput,{value:newRunCode,onChange:e=>setNewRunCode(e.target.value),onKeyDown:e=>e.key==='Enter'&&handleAddRunCode(),placeholder:\"Enter run code\"}),/*#__PURE__*/_jsx(AddButton,{onClick:handleAddRunCode,disabled:!newRunCode.trim(),children:\"Add\"})]}),/*#__PURE__*/_jsx(CodeList,{children:driverRunCodes.length===0?/*#__PURE__*/_jsx(EmptyState,{children:\"No run codes added yet\"}):driverRunCodes.map(codeColor=>/*#__PURE__*/_jsxs(CodeRow,{children:[/*#__PURE__*/_jsx(ColorIndicator,{color:codeColor.color}),/*#__PURE__*/_jsx(CodeText,{children:codeColor.code}),!isViewMode&&/*#__PURE__*/_jsx(DeleteButton,{onClick:()=>handleRemoveRunCode(codeColor.code),title:\"Remove\",children:/*#__PURE__*/_jsx(FiX,{size:16})})]},codeColor.code))})]})]})}),/*#__PURE__*/_jsx(TripTemplateManager,{templates:dutyTemplates,onTemplatesChange:setDutyTemplates,onError:setTemplateError,vehicleBlockCodes:vehicleBlockCodes,driverRunCodes:driverRunCodes,readOnly:isViewMode})]});};export default CreateServiceSchedule;","map":{"version":3,"names":["React","useState","useMemo","useEffect","useNavigate","useParams","FiArrowLeft","FiX","FiCopy","FiEye","styled","Button","theme","PageContainer","PageHeader","PageTitle","HeaderActions","FormCard","FormGrid","FormGroup","Label","Input","ErrorMessage","apiService","TripTemplateManager","MultiSelectSearchDropdown","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","CodesContainer","div","_templateObject","_taggedTemplateLiteral","colors","card","border","borderRadius","lg","spacing","CodesGrid","_templateObject2","xl","CodeColumn","_templateObject3","CodeColumnHeader","h3","_templateObject4","textPrimary","md","typography","fontSize","fontWeight","semibold","CodeAddForm","_templateObject5","xs","CodeInput","input","_templateObject6","surface","sm","primary","AddButton","button","_templateObject7","primaryHover","CodeList","_templateObject8","CodeRow","_templateObject9","surfaceHover","ColorIndicator","_templateObject0","props","color","CodeText","span","_templateObject1","medium","DeleteButton","_templateObject10","textSecondary","error","EmptyState","_templateObject11","textMuted","CloneSection","_templateObject12","CloneLabel","_templateObject13","CloneDropdownWrapper","_templateObject14","generateRandomColor","hue","Math","floor","random","saturation","lightness","concat","CreateServiceSchedule","navigate","id","isViewMode","window","location","pathname","includes","formData","setFormData","name","errors","setErrors","isSubmitting","setIsSubmitting","isLoading","setIsLoading","dutyTemplates","setDutyTemplates","templateError","setTemplateError","vehicleBlockCodes","setVehicleBlockCodes","driverRunCodes","setDriverRunCodes","newBlockCode","setNewBlockCode","newRunCode","setNewRunCode","selectedCloneSchedule","setSelectedCloneSchedule","loadScheduleForViewing","searchSchedules","searchTerm","trim","getServiceSchedules","allSchedules","filter","schedule","toLowerCase","console","handleCloneScheduleChange","schedules","length","selectedSchedule","handleCloneSelect","scheduleId","getServiceScheduleById","vehicleBlockTemplates","vehicleBlocks","map","block","code","blockIdToCodeMap","Map","forEach","set","driverRunTemplates","driverRuns","run","runIdToCodeMap","mappedTemplates","template","_objectSpread","vehicleBlockCode","vehicleBlockTemplateId","get","undefined","driverRunCode","driverRunTemplateId","alert","blockCodes","Set","runCodes","t","add","currentBlockCodes","c","currentRunCodes","newBlockCodes","Array","from","has","newRunCodes","prev","handleAddBlockCode","find","handleRemoveBlockCode","templates","handleAddRunCode","handleRemoveRunCode","handleInputChange","e","value","target","validateForm","newErrors","Object","keys","handleSubmit","preventDefault","scheduleData","startTime","split","substring","endTime","dutyType","createServiceSchedule","handleCancel","className","children","style","textAlign","padding","marginRight","variant","onClick","disabled","size","values","onChange","onSearch","displayValue","renderItem","dutyTemplateCount","marginTop","vehicleBlockCount","driverRunCount","placeholder","minSearchLength","searchPromptMessage","onSubmit","htmlFor","type","hasError","readOnly","onKeyDown","key","codeColor","title","onTemplatesChange","onError"],"sources":["/home/mhmdal/Projects/moveo-master/moveo/src/pages/ServiceSchedules/CreateServiceSchedule.tsx"],"sourcesContent":["import React, { useState, useMemo, useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { FiArrowLeft, FiX, FiCopy, FiEye } from 'react-icons/fi';\nimport styled from 'styled-components';\nimport { Button } from '../../styles/GlobalStyles';\nimport { theme } from '../../styles/theme';\nimport { \n  PageContainer,\n  PageHeader,\n  PageTitle,\n  HeaderActions,\n  FormCard,\n  FormGrid,\n  FormGroup,\n  Label,\n  Input,\n  ErrorMessage\n} from '../../components/Common/CommonStyles';\nimport { apiService } from '../../services/apiService';\nimport TripTemplateManager, { CodeColor } from '../../components/Forms/TripTemplateManager';\nimport MultiSelectSearchDropdown from '../../components/UI/DropDowns/MultiSelectSearchDropdown';\nimport { DutyTemplate, ServiceSchedule } from '../../types';\n\ninterface ServiceScheduleFormData {\n  name: string;\n}\n\nconst CodesContainer = styled.div`\n  background: ${theme.colors.card};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.lg};\n  padding: ${theme.spacing.lg};\n  margin-bottom: ${theme.spacing.lg};\n`;\n\nconst CodesGrid = styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: ${theme.spacing.xl};\n  \n  @media (max-width: 768px) {\n    grid-template-columns: 1fr;\n  }\n`;\n\nconst CodeColumn = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst CodeColumnHeader = styled.h3`\n  color: ${theme.colors.textPrimary};\n  margin: 0 0 ${theme.spacing.md} 0;\n  font-size: ${theme.typography.fontSize.lg};\n  font-weight: ${theme.typography.fontWeight.semibold};\n`;\n\nconst CodeAddForm = styled.div`\n  display: flex;\n  gap: ${theme.spacing.xs};\n  align-items: center;\n  margin-bottom: ${theme.spacing.md};\n  padding-bottom: ${theme.spacing.md};\n  border-bottom: 1px solid ${theme.colors.border};\n`;\n\nconst CodeInput = styled.input`\n  flex: 1;\n  background: ${theme.colors.surface};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.sm};\n  padding: ${theme.spacing.xs} ${theme.spacing.sm};\n  font-size: ${theme.typography.fontSize.sm};\n  font-family: monospace;\n  color: ${theme.colors.textPrimary};\n  \n  &:focus {\n    outline: none;\n    border-color: ${theme.colors.primary};\n  }\n`;\n\nconst AddButton = styled.button`\n  background: ${theme.colors.primary};\n  color: white;\n  border: none;\n  padding: ${theme.spacing.xs} ${theme.spacing.md};\n  border-radius: ${theme.borderRadius.sm};\n  font-size: ${theme.typography.fontSize.sm};\n  cursor: pointer;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n\n  &:hover {\n    background: ${theme.colors.primaryHover};\n  }\n  \n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n\nconst CodeList = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: ${theme.spacing.xs};\n`;\n\nconst CodeRow = styled.div`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  padding: ${theme.spacing.sm};\n  background: ${theme.colors.surface};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.sm};\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: ${theme.colors.surfaceHover};\n    border-color: ${theme.colors.primary};\n  }\n`;\n\nconst ColorIndicator = styled.div<{ color: string }>`\n  width: 20px;\n  height: 20px;\n  border-radius: 4px;\n  background-color: ${props => props.color};\n  border: 1px solid ${theme.colors.border};\n  flex-shrink: 0;\n`;\n\nconst CodeText = styled.span`\n  flex: 1;\n  font-family: monospace;\n  font-size: ${theme.typography.fontSize.sm};\n  color: ${theme.colors.textPrimary};\n  font-weight: ${theme.typography.fontWeight.medium};\n`;\n\nconst DeleteButton = styled.button`\n  background: transparent;\n  border: none;\n  color: ${theme.colors.textSecondary};\n  cursor: pointer;\n  padding: ${theme.spacing.xs};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: ${theme.borderRadius.sm};\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  \n  &:hover {\n    color: ${theme.colors.error};\n    background: ${theme.colors.error}10;\n  }\n`;\n\nconst EmptyState = styled.div`\n  padding: ${theme.spacing.md};\n  text-align: center;\n  color: ${theme.colors.textMuted};\n  font-style: italic;\n  font-size: ${theme.typography.fontSize.sm};\n`;\n\nconst CloneSection = styled.div`\n  background: ${theme.colors.surface};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.lg};\n  padding: ${theme.spacing.lg};\n  margin-bottom: ${theme.spacing.lg};\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.md};\n`;\n\nconst CloneLabel = styled.div`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  color: ${theme.colors.textPrimary};\n  font-weight: ${theme.typography.fontWeight.medium};\n  white-space: nowrap;\n  min-width: 180px;\n`;\n\nconst CloneDropdownWrapper = styled.div`\n  flex: 1;\n`;\n\n// Generate a random vibrant color\nconst generateRandomColor = (): string => {\n  // Generate HSL color with high saturation and medium lightness for vibrant colors\n  const hue = Math.floor(Math.random() * 360);\n  const saturation = 65 + Math.floor(Math.random() * 20); // 65-85%\n  const lightness = 45 + Math.floor(Math.random() * 15); // 45-60%\n  return `hsl(${hue}, ${saturation}%, ${lightness}%)`;\n};\n\nconst CreateServiceSchedule: React.FC = () => {\n  const navigate = useNavigate();\n  const { id } = useParams<{ id: string }>();\n  const isViewMode = window.location.pathname.includes('/view/');\n  \n  const [formData, setFormData] = useState<ServiceScheduleFormData>({\n    name: ''\n  });\n  const [errors, setErrors] = useState<Partial<ServiceScheduleFormData>>({});\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [dutyTemplates, setDutyTemplates] = useState<DutyTemplate[]>([]);\n  const [templateError, setTemplateError] = useState<string | null>(null);\n  \n  const [vehicleBlockCodes, setVehicleBlockCodes] = useState<CodeColor[]>([]);\n  const [driverRunCodes, setDriverRunCodes] = useState<CodeColor[]>([]);\n  const [newBlockCode, setNewBlockCode] = useState<string>('');\n  const [newRunCode, setNewRunCode] = useState<string>('');\n  \n  // Clone functionality (only in create mode)\n  const [selectedCloneSchedule, setSelectedCloneSchedule] = useState<ServiceSchedule[]>([]);\n\n  // Load schedule data in view mode\n  useEffect(() => {\n    if (isViewMode && id) {\n      loadScheduleForViewing(id);\n    }\n  }, [isViewMode, id]);\n\n  const searchSchedules = async (searchTerm: string): Promise<ServiceSchedule[]> => {\n    try {\n      if (!searchTerm.trim()) {\n        // Load all schedules when dropdown is opened\n        return await apiService.getServiceSchedules();\n      }\n      const allSchedules = await apiService.getServiceSchedules();\n      return allSchedules.filter(schedule =>\n        schedule.name.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    } catch (error) {\n      console.error('Error searching schedules:', error);\n      return [];\n    }\n  };\n\n  const handleCloneScheduleChange = (schedules: ServiceSchedule[]) => {\n    // Only allow single selection\n    if (schedules.length > 0) {\n      const selectedSchedule = schedules[schedules.length - 1];\n      setSelectedCloneSchedule([selectedSchedule]);\n      handleCloneSelect(selectedSchedule.id);\n    } else {\n      setSelectedCloneSchedule([]);\n      handleCloneSelect('');\n    }\n  };\n\n  const loadScheduleForViewing = async (scheduleId: string) => {\n    try {\n      setIsLoading(true);\n      const schedule = await apiService.getServiceScheduleById(scheduleId);\n      \n      // Set form data without modification for viewing\n      setFormData({\n        name: schedule.name\n      });\n\n      // Load vehicle block templates and create a map of id -> code\n      const vehicleBlockTemplates = (schedule as any).vehicleBlockTemplates || [];\n      const vehicleBlocks = vehicleBlockTemplates.map((block: any) => ({\n        code: block.code,\n        color: block.color\n      }));\n      setVehicleBlockCodes(vehicleBlocks);\n      \n      const blockIdToCodeMap = new Map<string, string>();\n      vehicleBlockTemplates.forEach((block: any) => {\n        blockIdToCodeMap.set(block.id, block.code);\n      });\n\n      // Load driver run templates and create a map of id -> code\n      const driverRunTemplates = (schedule as any).driverRunTemplates || [];\n      const driverRuns = driverRunTemplates.map((run: any) => ({\n        code: run.code,\n        color: run.color\n      }));\n      setDriverRunCodes(driverRuns);\n      \n      const runIdToCodeMap = new Map<string, string>();\n      driverRunTemplates.forEach((run: any) => {\n        runIdToCodeMap.set(run.id, run.code);\n      });\n\n      // Load duty templates and map their block/run IDs to codes\n      if (schedule.dutyTemplates) {\n        const mappedTemplates = schedule.dutyTemplates.map((template: any) => ({\n          ...template,\n          vehicleBlockCode: template.vehicleBlockTemplateId \n            ? blockIdToCodeMap.get(template.vehicleBlockTemplateId) \n            : undefined,\n          driverRunCode: template.driverRunTemplateId \n            ? runIdToCodeMap.get(template.driverRunTemplateId) \n            : undefined\n        }));\n        setDutyTemplates(mappedTemplates);\n      }\n    } catch (error) {\n      console.error('Error loading schedule:', error);\n      alert('Failed to load schedule. Please try again.');\n      navigate('/service-schedules');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleCloneSelect = async (scheduleId: string) => {\n    if (!scheduleId) {\n      // Clear form if deselected\n      setFormData({ name: '' });\n      setVehicleBlockCodes([]);\n      setDriverRunCodes([]);\n      setDutyTemplates([]);\n      return;\n    }\n\n    try {\n      const schedule = await apiService.getServiceScheduleById(scheduleId);\n      \n      // Set form data with a modified name for cloning\n      setFormData({\n        name: `${schedule.name} (Copy)`\n      });\n\n      // Load vehicle block templates and create a map of id -> code\n      const vehicleBlockTemplates = (schedule as any).vehicleBlockTemplates || [];\n      const vehicleBlocks = vehicleBlockTemplates.map((block: any) => ({\n        code: block.code,\n        color: block.color\n      }));\n      setVehicleBlockCodes(vehicleBlocks);\n      \n      const blockIdToCodeMap = new Map<string, string>();\n      vehicleBlockTemplates.forEach((block: any) => {\n        blockIdToCodeMap.set(block.id, block.code);\n      });\n\n      // Load driver run templates and create a map of id -> code\n      const driverRunTemplates = (schedule as any).driverRunTemplates || [];\n      const driverRuns = driverRunTemplates.map((run: any) => ({\n        code: run.code,\n        color: run.color\n      }));\n      setDriverRunCodes(driverRuns);\n      \n      const runIdToCodeMap = new Map<string, string>();\n      driverRunTemplates.forEach((run: any) => {\n        runIdToCodeMap.set(run.id, run.code);\n      });\n\n      // Load duty templates and map their block/run IDs to codes\n      if (schedule.dutyTemplates) {\n        const mappedTemplates = schedule.dutyTemplates.map((template: any) => ({\n          ...template,\n          vehicleBlockCode: template.vehicleBlockTemplateId \n            ? blockIdToCodeMap.get(template.vehicleBlockTemplateId) \n            : undefined,\n          driverRunCode: template.driverRunTemplateId \n            ? runIdToCodeMap.get(template.driverRunTemplateId) \n            : undefined\n        }));\n        setDutyTemplates(mappedTemplates);\n      }\n    } catch (error) {\n      console.error('Error loading schedule for cloning:', error);\n      alert('Failed to load schedule for cloning. Please try again.');\n    }\n  };\n\n  // Sync codes from templates\n  useMemo(() => {\n    const blockCodes = new Set<string>();\n    const runCodes = new Set<string>();\n    \n    dutyTemplates.forEach(t => {\n      if (t.vehicleBlockCode) blockCodes.add(t.vehicleBlockCode);\n      if (t.driverRunCode) runCodes.add(t.driverRunCode);\n    });\n\n    // Add codes from templates that aren't in state yet\n    const currentBlockCodes = new Set(vehicleBlockCodes.map(c => c.code));\n    const currentRunCodes = new Set(driverRunCodes.map(c => c.code));\n    \n    const newBlockCodes = Array.from(blockCodes).filter(c => !currentBlockCodes.has(c));\n    const newRunCodes = Array.from(runCodes).filter(c => !currentRunCodes.has(c));\n\n    if (newBlockCodes.length > 0) {\n      setVehicleBlockCodes(prev => [\n        ...prev,\n        ...newBlockCodes.map((code) => ({\n          code,\n          color: generateRandomColor()\n        }))\n      ]);\n    }\n\n    if (newRunCodes.length > 0) {\n      setDriverRunCodes(prev => [\n        ...prev,\n        ...newRunCodes.map((code) => ({\n          code,\n          color: generateRandomColor()\n        }))\n      ]);\n    }\n  }, [dutyTemplates]);\n\n  const handleAddBlockCode = () => {\n    const code = newBlockCode.trim();\n    if (code && !vehicleBlockCodes.find(c => c.code === code)) {\n      const color = generateRandomColor();\n      setVehicleBlockCodes([...vehicleBlockCodes, { code, color }]);\n      setNewBlockCode('');\n    }\n  };\n\n  const handleRemoveBlockCode = (code: string) => {\n    setVehicleBlockCodes(vehicleBlockCodes.filter(c => c.code !== code));\n    // Remove code from templates\n    setDutyTemplates(templates => templates.map(t => \n      t.vehicleBlockCode === code ? { ...t, vehicleBlockCode: undefined } : t\n    ));\n  };\n\n  const handleAddRunCode = () => {\n    const code = newRunCode.trim();\n    if (code && !driverRunCodes.find(c => c.code === code)) {\n      const color = generateRandomColor();\n      setDriverRunCodes([...driverRunCodes, { code, color }]);\n      setNewRunCode('');\n    }\n  };\n\n  const handleRemoveRunCode = (code: string) => {\n    setDriverRunCodes(driverRunCodes.filter(c => c.code !== code));\n    // Remove code from templates\n    setDutyTemplates(templates => templates.map(t => \n      t.driverRunCode === code ? { ...t, driverRunCode: undefined } : t\n    ));\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    \n    // Clear error when user starts typing\n    if (errors[name as keyof ServiceScheduleFormData]) {\n      setErrors(prev => ({ ...prev, [name]: undefined }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Partial<ServiceScheduleFormData> = {};\n\n    if (!formData.name.trim()) {\n      newErrors.name = 'Schedule name is required';\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setIsSubmitting(true);\n    \n    try {\n      const scheduleData = {\n        name: formData.name,\n        vehicleBlockCodes: vehicleBlockCodes.map(block => ({\n          code: block.code,\n          color: block.color\n        })),\n        driverRunCodes: driverRunCodes.map(run => ({\n          code: run.code,\n          color: run.color\n        })),\n        dutyTemplates: dutyTemplates.map(template => ({\n          // Only send the fields needed for creation - NO IDs\n          startTime: template.startTime.split('T')[1].substring(0, 5), // Extract HH:MM\n          endTime: template.endTime.split('T')[1].substring(0, 5), // Extract HH:MM\n          dutyType: template.dutyType,\n          // Only send codes, let backend create new associations\n          vehicleBlockCode: template.vehicleBlockCode,\n          driverRunCode: template.driverRunCode\n          // Explicitly NOT sending: id, vehicleBlockTemplateId, driverRunTemplateId, scheduleId\n        }))\n      };\n      \n      await apiService.createServiceSchedule(scheduleData);\n      navigate('/service-schedules');\n    } catch (error) {\n      console.error('Error creating service schedule:', error);\n      alert('Failed to create service schedule. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleCancel = () => {\n    navigate('/service-schedules');\n  };\n\n  if (isLoading) {\n    return (\n      <PageContainer className=\"fade-in\">\n        <div style={{ textAlign: 'center', padding: '40px' }}>Loading schedule...</div>\n      </PageContainer>\n    );\n  }\n\n  return (\n    <PageContainer className=\"fade-in\">\n      <PageHeader>\n        <PageTitle>\n          {isViewMode ? (\n            <>\n              <FiEye style={{ marginRight: '8px' }} />\n              View Service Schedule\n            </>\n          ) : (\n            'Create Service Schedule'\n          )}\n        </PageTitle>\n        <HeaderActions>\n          <Button variant=\"secondary\" onClick={handleCancel}>\n            <FiArrowLeft style={{ marginRight: '8px' }} />\n            Back to List\n          </Button>\n          {!isViewMode && (\n            <Button variant=\"primary\" onClick={handleSubmit} disabled={isSubmitting}>\n              {isSubmitting ? 'Creating...' : 'Create Schedule'}\n            </Button>\n          )}\n        </HeaderActions>\n      </PageHeader>\n\n      {!isViewMode && <CloneSection>\n        <CloneLabel>\n          <FiCopy size={18} />\n          Clone from existing:\n        </CloneLabel>\n        <CloneDropdownWrapper>\n          <MultiSelectSearchDropdown\n            values={selectedCloneSchedule}\n            onChange={handleCloneScheduleChange}\n            onSearch={searchSchedules}\n            displayValue={(schedule) => schedule.name}\n            renderItem={(schedule) => (\n              <div style={{ padding: '4px 0' }}>\n                <div style={{ fontWeight: '500', fontSize: '14px' }}>\n                  {schedule.name}\n                </div>\n                {schedule.dutyTemplateCount !== undefined && (\n                  <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '2px' }}>\n                    {schedule.dutyTemplateCount} templates • {schedule.vehicleBlockCount || 0} blocks • {schedule.driverRunCount || 0} runs\n                  </div>\n                )}\n              </div>\n            )}\n            placeholder=\"Search or select a schedule to clone...\"\n            minSearchLength={0}\n            searchPromptMessage=\"Start typing to search or see all schedules\"\n          />\n        </CloneDropdownWrapper>\n      </CloneSection>}\n\n      <FormCard>\n        <form onSubmit={handleSubmit}>\n          <FormGrid>\n            <FormGroup>\n              <Label htmlFor=\"name\">Schedule Name *</Label>\n              <Input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleInputChange}\n                placeholder=\"Enter schedule name\"\n                hasError={!!errors.name}\n                disabled={isViewMode}\n                readOnly={isViewMode}\n              />\n              {errors.name && <ErrorMessage>{errors.name}</ErrorMessage>}\n            </FormGroup>\n\n          </FormGrid>\n        </form>\n      </FormCard>\n\n      {/* Code Management Section */}\n      <CodesContainer>\n        <CodesGrid>\n          {/* Vehicle Block Codes Column */}\n          <CodeColumn>\n            <CodeColumnHeader>Vehicle Blocks</CodeColumnHeader>\n            {!isViewMode && (\n              <CodeAddForm>\n                <CodeInput\n                  value={newBlockCode}\n                  onChange={(e) => setNewBlockCode(e.target.value)}\n                  onKeyDown={(e) => e.key === 'Enter' && handleAddBlockCode()}\n                  placeholder=\"Enter block code\"\n                />\n                <AddButton \n                  onClick={handleAddBlockCode}\n                  disabled={!newBlockCode.trim()}\n                >\n                  Add\n                </AddButton>\n              </CodeAddForm>\n            )}\n            <CodeList>\n              {vehicleBlockCodes.length === 0 ? (\n                <EmptyState>No block codes added yet</EmptyState>\n              ) : (\n                vehicleBlockCodes.map(codeColor => (\n                  <CodeRow key={codeColor.code}>\n                    <ColorIndicator color={codeColor.color} />\n                    <CodeText>{codeColor.code}</CodeText>\n                    {!isViewMode && (\n                      <DeleteButton \n                        onClick={() => handleRemoveBlockCode(codeColor.code)} \n                        title=\"Remove\"\n                      >\n                        <FiX size={16} />\n                      </DeleteButton>\n                    )}\n                  </CodeRow>\n                ))\n              )}\n            </CodeList>\n          </CodeColumn>\n\n          {/* Driver Run Codes Column */}\n          <CodeColumn>\n            <CodeColumnHeader>Driver Runs</CodeColumnHeader>\n            {!isViewMode && (\n              <CodeAddForm>\n                <CodeInput\n                  value={newRunCode}\n                  onChange={(e) => setNewRunCode(e.target.value)}\n                  onKeyDown={(e) => e.key === 'Enter' && handleAddRunCode()}\n                  placeholder=\"Enter run code\"\n                />\n                <AddButton \n                  onClick={handleAddRunCode}\n                  disabled={!newRunCode.trim()}\n                >\n                  Add\n                </AddButton>\n              </CodeAddForm>\n            )}\n            <CodeList>\n              {driverRunCodes.length === 0 ? (\n                <EmptyState>No run codes added yet</EmptyState>\n              ) : (\n                driverRunCodes.map(codeColor => (\n                  <CodeRow key={codeColor.code}>\n                    <ColorIndicator color={codeColor.color} />\n                    <CodeText>{codeColor.code}</CodeText>\n                    {!isViewMode && (\n                      <DeleteButton \n                        onClick={() => handleRemoveRunCode(codeColor.code)} \n                        title=\"Remove\"\n                      >\n                        <FiX size={16} />\n                      </DeleteButton>\n                    )}\n                  </CodeRow>\n                ))\n              )}\n            </CodeList>\n          </CodeColumn>\n        </CodesGrid>\n      </CodesContainer>\n\n      <TripTemplateManager\n        templates={dutyTemplates}\n        onTemplatesChange={setDutyTemplates}\n        onError={setTemplateError}\n        vehicleBlockCodes={vehicleBlockCodes}\n        driverRunCodes={driverRunCodes}\n        readOnly={isViewMode}\n      />\n    </PageContainer>\n  );\n};\n\nexport default CreateServiceSchedule;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}