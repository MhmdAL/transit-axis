{"ast":null,"code":"import _objectSpread from\"/home/mhmdal/Projects/moveo-master/moveo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _taggedTemplateLiteral from\"/home/mhmdal/Projects/moveo-master/moveo/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0,_templateObject1,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19;import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{FiCalendar,FiMap,FiUsers,FiTruck,FiRefreshCw,FiPlus}from'react-icons/fi';import{Button}from'../../styles/GlobalStyles';import{PageContainer,PageHeader,PageTitle,HeaderActions,Table,TableHeader,TableHeaderCell,TableBody,TableCell}from'../../components/Common/CommonStyles';import styled from'styled-components';import{theme}from'../../styles/theme';import AssignmentModal from'../../components/Modals/AssignmentModal';import BlockAssignmentModal from'../../components/Modals/BlockAssignmentModal';import RunAssignmentModal from'../../components/Modals/RunAssignmentModal';import MultiSelectSearchDropdown from'../../components/UI/DropDowns/MultiSelectSearchDropdown';import{dataService}from'../../services/dataService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AssignmentContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  gap: \",\";\\n\"])),theme.spacing.lg);const SelectionControls=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: \",\";\\n  margin-bottom: \",\";\\n  flex-wrap: nowrap;\\n  align-items: center;\\n  \\n  @media (max-width: 1200px) {\\n    flex-wrap: wrap;\\n  }\\n\"])),theme.spacing.md,theme.spacing.lg);const DateSelector=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n  min-width: 300px;\\n\"])),theme.spacing.sm);const DateRangeContainer=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n\"])),theme.spacing.sm);const DateInput=styled.input(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  padding: \",\" \",\";\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  background: \",\";\\n  color: \",\";\\n  font-size: \",\";\\n  \\n  &:focus {\\n    outline: none;\\n    border-color: \",\";\\n  }\\n\"])),theme.spacing.sm,theme.spacing.md,theme.colors.border,theme.borderRadius.md,theme.colors.card,theme.colors.textPrimary,theme.typography.fontSize.sm,theme.colors.primary);const SearchDropdownWrapper=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  min-width: 200px;\\n  flex: 1;\\n  max-width: 250px;\\n\"])));const RouteSelect=styled.select(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  padding: \",\" \",\";\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  background: \",\";\\n  color: \",\";\\n  font-size: \",\";\\n  min-width: 200px;\\n  \\n  &:focus {\\n    outline: none;\\n    border-color: \",\";\\n  }\\n\"])),theme.spacing.sm,theme.spacing.md,theme.colors.border,theme.borderRadius.md,theme.colors.card,theme.colors.textPrimary,theme.typography.fontSize.sm,theme.colors.primary);const Checkbox=styled.input(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  width: 18px;\\n  height: 18px;\\n  accent-color: \",\";\\n\"])),theme.colors.primary);const FloatingActionBar=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  bottom: \",\";\\n  right: \",\";\\n  background: \",\";\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  padding: \",\";\\n  box-shadow: \",\";\\n  display: \",\";\\n  align-items: center;\\n  gap: \",\";\\n  z-index: \",\";\\n  transition: all 0.3s ease;\\n\"])),theme.spacing.xl,theme.spacing.xl,theme.colors.card,theme.colors.border,theme.borderRadius.lg,theme.spacing.lg,theme.shadows.lg,_ref=>{let{visible}=_ref;return visible?'flex':'none';},theme.spacing.md,theme.zIndex.modal);const SelectionCount=styled.div(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"\\n  color: \",\";\\n  font-weight: \",\";\\n\"])),theme.colors.textPrimary,theme.typography.fontWeight.medium);const AssignButton=styled(Button)(_templateObject1||(_templateObject1=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n\"])),theme.spacing.sm);const EmptyState=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  text-align: center;\\n  padding: \",\";\\n  color: \",\";\\n\"])),theme.spacing['3xl'],theme.colors.textSecondary);const LoadingState=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  text-align: center;\\n  padding: \",\";\\n  color: \",\";\\n\"])),theme.spacing.xl,theme.colors.textSecondary);const UnsavedChangesWarning=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  background: \",\"20;\\n  border: 1px solid \",\";\\n  border-radius: \",\";\\n  padding: \",\";\\n  margin-bottom: \",\";\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  gap: \",\";\\n\"])),theme.colors.warning,theme.colors.warning,theme.borderRadius.md,theme.spacing.md,theme.spacing.lg,theme.spacing.md);const WarningText=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  color: \",\";\\n  font-size: \",\";\\n  font-weight: \",\";\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n\"])),theme.colors.warning,theme.typography.fontSize.sm,theme.typography.fontWeight.medium,theme.spacing.sm);const ActionButtons=styled.div(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: \",\";\\n\"])),theme.spacing.sm);const SaveButton=styled.button(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  background: \",\";\\n  color: white;\\n  border: none;\\n  padding: \",\" \",\";\\n  border-radius: \",\";\\n  font-size: \",\";\\n  font-weight: \",\";\\n  cursor: pointer;\\n  transition: all 0.2s ease;\\n  display: flex;\\n  align-items: center;\\n  gap: \",\";\\n\\n  &:hover:not(:disabled) {\\n    background: \",\";\\n  }\\n\\n  &:disabled {\\n    opacity: 0.6;\\n    cursor: not-allowed;\\n  }\\n\"])),theme.colors.primary,theme.spacing.sm,theme.spacing.md,theme.borderRadius.md,theme.typography.fontSize.sm,theme.typography.fontWeight.medium,theme.spacing.sm,theme.colors.primaryHover);const DiscardButton=styled.button(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\\n  background: transparent;\\n  color: \",\";\\n  border: 1px solid \",\";\\n  padding: \",\" \",\";\\n  border-radius: \",\";\\n  font-size: \",\";\\n  font-weight: \",\";\\n  cursor: pointer;\\n  transition: all 0.2s ease;\\n\\n  &:hover {\\n    background: \",\";\\n    border-color: \",\";\\n  }\\n\"])),theme.colors.textSecondary,theme.colors.border,theme.spacing.sm,theme.spacing.md,theme.borderRadius.md,theme.typography.fontSize.sm,theme.typography.fontWeight.medium,theme.colors.surfaceHover,theme.colors.textSecondary);const ModifiedRow=styled.tr(_templateObject17||(_templateObject17=_taggedTemplateLiteral([\"\\n  background: \",\";\\n  border-left: 3px solid \",\";\\n\"])),props=>{if(props.isNewlyAssigned)return\"\".concat(theme.colors.success,\"15\");if(props.isModified)return\"\".concat(theme.colors.warning,\"15\");return'transparent';},props=>{if(props.isNewlyAssigned)return theme.colors.success;if(props.isModified)return theme.colors.warning;return'transparent';});const StatusIndicator=styled.span(_templateObject18||(_templateObject18=_taggedTemplateLiteral([\"\\n  display: inline-flex;\\n  align-items: center;\\n  gap: \",\";\\n  \\n  &::before {\\n    content: '';\\n    width: 8px;\\n    height: 8px;\\n    border-radius: 50%;\\n    background: \",\";\\n  }\\n\"])),theme.spacing.xs,props=>{if(props.isNewlyAssigned)return theme.colors.success;if(props.isModified)return theme.colors.warning;return'transparent';});const ColoredTableCell=styled(TableCell)(_templateObject19||(_templateObject19=_taggedTemplateLiteral([\"\\n  background: \",\";\\n  border-left: \",\";\\n  transition: all 0.2s ease;\\n  cursor: \",\";\\n  \\n  \",\"\\n  \\n  \",\"\\n\"])),props=>props.$bgColor?\"color-mix(in srgb, \".concat(props.$bgColor,\" 15%, transparent)\"):'transparent',props=>props.$bgColor?\"3px solid \".concat(props.$bgColor):'none',props=>props.$clickable?'pointer':'default',props=>props.$bgColor&&\"\\n    &:hover {\\n      background: color-mix(in srgb, \".concat(props.$bgColor,\" 25%, transparent);\\n    }\\n  \"),props=>props.$clickable&&!props.$bgColor&&\"\\n    &:hover {\\n      background: \".concat(theme.colors.surfaceHover,\";\\n    }\\n  \"));const AssignmentInterface=()=>{const navigate=useNavigate();const[selectedDateRange,setSelectedDateRange]=useState(()=>{const today=new Date();return{startDate:today.toISOString().split('T')[0],endDate:today.toISOString().split('T')[0]};});const[selectedRoutes,setSelectedRoutes]=useState([]);const[selectedDrivers,setSelectedDrivers]=useState([]);const[selectedVehicles,setSelectedVehicles]=useState([]);const[selectedDutyTypes,setSelectedDutyTypes]=useState([]);const[trips,setTrips]=useState([]);const[filteredTrips,setFilteredTrips]=useState([]);const[selectedTrips,setSelectedTrips]=useState(new Set());const[loading,setLoading]=useState(false);const[showAssignmentModal,setShowAssignmentModal]=useState(false);// State management for changes\nconst[hasUnsavedChanges,setHasUnsavedChanges]=useState(false);const[originalTrips,setOriginalTrips]=useState([]);const[isSaving,setIsSaving]=useState(false);// Block and Run assignment modals\nconst[showBlockModal,setShowBlockModal]=useState(false);const[showRunModal,setShowRunModal]=useState(false);const[selectedBlock,setSelectedBlock]=useState(null);const[selectedRun,setSelectedRun]=useState(null);// Routes state\nconst[routes,setRoutes]=useState([]);const[routesLoading,setRoutesLoading]=useState(true);const[error,setError]=useState(null);// Load routes on component mount\nuseEffect(()=>{const loadRoutes=async()=>{try{setRoutesLoading(true);setError(null);const routesData=await dataService.getRoutes();setRoutes(routesData);}catch(error){console.error('Error loading routes:',error);setError('Failed to load routes. Please try again.');}finally{setRoutesLoading(false);}};loadRoutes();},[]);useEffect(()=>{// Check if at least one filter is selected\nconst hasFilter=selectedDateRange.startDate&&selectedDateRange.endDate&&(selectedRoutes.length>0||selectedDrivers.length>0||selectedVehicles.length>0||selectedDutyTypes.length>0);if(hasFilter){loadTrips();}else{setTrips([]);setFilteredTrips([]);}},[selectedDateRange,selectedRoutes,selectedDrivers,selectedVehicles,selectedDutyTypes]);useEffect(()=>{setSelectedTrips(new Set());// Clear selection when trips change\n},[trips]);// Search functions for SearchDropdown components\nconst searchDrivers=async searchTerm=>{try{if(!searchTerm.trim()){return[];}return await dataService.getDrivers({search:searchTerm.trim(),limit:50});}catch(error){console.error('Error searching drivers:',error);return[];}};const searchVehicles=async searchTerm=>{try{if(!searchTerm.trim()){return[];}return await dataService.getVehicles({search:searchTerm.trim(),limit:50});}catch(error){console.error('Error searching vehicles:',error);return[];}};const loadTrips=async()=>{try{setLoading(true);setError(null);// Build query parameters for backend filtering\nconst queryParams={startDate:selectedDateRange.startDate,endDate:selectedDateRange.endDate};// Add duty type filter\nif(selectedDutyTypes.length>0){queryParams.dutyType=selectedDutyTypes[0];// Backend currently supports single duty type\n}else{queryParams.dutyType='TRIP';// Default to TRIP if no duty type selected\n}// Add multi-select filters to backend query\nif(selectedRoutes.length>0){queryParams.routeIds=selectedRoutes.map(route=>route.id);}if(selectedDrivers.length>0){queryParams.driverIds=selectedDrivers.map(driver=>driver.id);}if(selectedVehicles.length>0){queryParams.vehicleIds=selectedVehicles.map(vehicle=>vehicle.id);}const duties=await dataService.getDuties(queryParams);// Convert duties to trips format and sort by start time\nconst tripsData=duties.sort((a,b)=>new Date(a.startTime).getTime()-new Date(b.startTime).getTime())// Sort duties by start time first\n.map((duty,index)=>{var _duty$tripDuties,_duty$tripDuties$,_duty$tripDuties$$rou,_duty$driver,_vehicleBlockTemplate,_driverRunTemplate;const routeName=duty.dutyType==='TRIP'?((_duty$tripDuties=duty.tripDuties)===null||_duty$tripDuties===void 0?void 0:(_duty$tripDuties$=_duty$tripDuties[0])===null||_duty$tripDuties$===void 0?void 0:(_duty$tripDuties$$rou=_duty$tripDuties$.route)===null||_duty$tripDuties$$rou===void 0?void 0:_duty$tripDuties$$rou.name)||'Unknown Route':'-';const driverName=(_duty$driver=duty.driver)!==null&&_duty$driver!==void 0&&_duty$driver.user?\"\".concat(duty.driver.user.name):undefined;const vehicleName=duty.vehicle?\"\".concat(duty.vehicle.fleetNo||'',\" - \").concat(duty.vehicle.plateNo||'').trim():undefined;// Extract block and run codes\nconst block=duty.block;const run=duty.run;const vehicleBlockCode=block===null||block===void 0?void 0:block.code;// Remove date suffix\nconst driverRunCode=run===null||run===void 0?void 0:run.code;// Remove date suffix\nreturn{id:duty.id,dutyId:duty.id,tripNumber:\"T-\".concat(String(index+1).padStart(3,'0')),routeName,date:new Date(duty.startTime).toLocaleDateString(),scheduledStartTime:new Date(duty.startTime).toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',hour12:false}),scheduledEndTime:new Date(duty.endTime).toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit',hour12:false}),status:'planned',assignedDriver:driverName,assignedVehicle:vehicleName,dutyType:duty.dutyType,driverId:duty.driverId,vehicleId:duty.vehicleId,driver:duty.driver,vehicle:duty.vehicle,vehicleBlockCode:vehicleBlockCode,vehicleBlockColor:block===null||block===void 0?void 0:(_vehicleBlockTemplate=block.vehicleBlockTemplate)===null||_vehicleBlockTemplate===void 0?void 0:_vehicleBlockTemplate.color,driverRunCode:driverRunCode,driverRunColor:run===null||run===void 0?void 0:(_driverRunTemplate=run.driverRunTemplate)===null||_driverRunTemplate===void 0?void 0:_driverRunTemplate.color,// Initialize tracking fields\noriginalAssignedDriver:driverName,originalAssignedVehicle:vehicleName,isModified:false,isNewlyAssigned:false};});setTrips(tripsData);setFilteredTrips(tripsData);setOriginalTrips([...tripsData]);// Store original data\nsetHasUnsavedChanges(false);// Reset change tracking\n}catch(error){console.error('Error loading trips:',error);setError('Failed to load trip duties. Please try again.');}finally{setLoading(false);}};const handleSelectTrip=tripId=>{const newSelected=new Set(selectedTrips);if(newSelected.has(tripId)){newSelected.delete(tripId);}else{newSelected.add(tripId);}setSelectedTrips(newSelected);};const handleSelectAll=()=>{if(selectedTrips.size===filteredTrips.length){setSelectedTrips(new Set());}else{setSelectedTrips(new Set(filteredTrips.map(trip=>trip.id)));}};const handleAssign=()=>{setShowAssignmentModal(true);};const handleCreateDuty=()=>{navigate('/duties/create');};const handleAssignmentComplete=assignmentData=>{var _assignmentData$selec,_assignmentData$selec2;console.log('Assignment data:',assignmentData);console.log('Selected trips:',Array.from(selectedTrips));console.log('Selected drivers:',((_assignmentData$selec=assignmentData.selectedDrivers)===null||_assignmentData$selec===void 0?void 0:_assignmentData$selec.map(d=>d.name))||[]);console.log('Selected vehicles:',((_assignmentData$selec2=assignmentData.selectedVehicles)===null||_assignmentData$selec2===void 0?void 0:_assignmentData$selec2.map(v=>\"\".concat(v.plateNo,\" - \").concat(v.fleetNo)))||[]);// Apply assignments to selected trips\nconst updatedTrips=trips.map(trip=>{if(selectedTrips.has(trip.id)){const tripIndex=Array.from(selectedTrips).indexOf(trip.id);// Handle driver assignment (if drivers are selected)\nlet assignedDriver=null;let driverId=trip.driverId;let driver=trip.driver;let assignedDriverName=trip.assignedDriver;if(assignmentData.selectedDrivers.length>0){const driverIndex=tripIndex%assignmentData.selectedDrivers.length;assignedDriver=assignmentData.selectedDrivers[driverIndex];driverId=assignedDriver.id;driver=assignedDriver;assignedDriverName=assignedDriver.name;}// Handle vehicle assignment (if vehicles are selected)\nlet assignedVehicle=null;let vehicleId=trip.vehicleId;let vehicle=trip.vehicle;let assignedVehicleName=trip.assignedVehicle;if(assignmentData.selectedVehicles.length>0){const vehicleIndex=tripIndex%assignmentData.selectedVehicles.length;assignedVehicle=assignmentData.selectedVehicles[vehicleIndex];vehicleId=assignedVehicle.id;vehicle=assignedVehicle;assignedVehicleName=\"\".concat(assignedVehicle.plateNo,\" - \").concat(assignedVehicle.fleetNo);}return _objectSpread(_objectSpread({},trip),{},{assignedDriver:assignedDriverName,assignedVehicle:assignedVehicleName,driverId:driverId,vehicleId:vehicleId,driver:driver,vehicle:vehicle,isModified:true,isNewlyAssigned:!trip.assignedDriver&&!trip.assignedVehicle});}return trip;});setTrips(updatedTrips);setFilteredTrips(updatedTrips);setHasUnsavedChanges(true);setSelectedTrips(new Set());// Clear selection after assignment\n};const handleSaveChanges=async()=>{try{setIsSaving(true);// Get modified trips\nconst modifiedTrips=trips.filter(trip=>trip.isModified);if(modifiedTrips.length===0){console.log('No changes to save');return;}// Prepare assignments for bulk update\nconst assignments=modifiedTrips.map(trip=>({dutyId:trip.dutyId,driverId:trip.driverId,vehicleId:trip.vehicleId}));// Call bulk update API\nawait dataService.bulkUpdateDutyAssignments({assignments});// Update all trips to reflect saved state\nconst updatedTrips=trips.map(trip=>_objectSpread(_objectSpread({},trip),{},{originalAssignedDriver:trip.assignedDriver,originalAssignedVehicle:trip.assignedVehicle,isModified:false,isNewlyAssigned:false}));setTrips(updatedTrips);setFilteredTrips(updatedTrips);setOriginalTrips(updatedTrips);setHasUnsavedChanges(false);console.log('Changes saved successfully');}catch(error){console.error('Error saving changes:',error);alert('Failed to save changes. Please try again.');}finally{setIsSaving(false);}};const handleDiscardChanges=()=>{if(window.confirm('Are you sure you want to discard all unsaved changes?')){setTrips([...originalTrips]);setFilteredTrips([...originalTrips]);setHasUnsavedChanges(false);setSelectedTrips(new Set());}};const handleBlockClick=(blockCode,blockColor)=>{var _dutiesWithBlock$;// Find all duties with this block code\nconst dutiesWithBlock=trips.filter(trip=>trip.vehicleBlockCode===blockCode);if(dutiesWithBlock.length===0)return;// Get current vehicle assignment (they should all be the same for a block)\nconst currentVehicle=(_dutiesWithBlock$=dutiesWithBlock[0])===null||_dutiesWithBlock$===void 0?void 0:_dutiesWithBlock$.assignedVehicle;setSelectedBlock({code:blockCode,color:blockColor,currentVehicle,dutyIds:dutiesWithBlock.map(t=>t.dutyId)});setShowBlockModal(true);};const handleRunClick=(runCode,runColor)=>{var _dutiesWithRun$;// Find all duties with this run code\nconst dutiesWithRun=trips.filter(trip=>trip.driverRunCode===runCode);if(dutiesWithRun.length===0)return;// Get current driver assignment (they should all be the same for a run)\nconst currentDriver=(_dutiesWithRun$=dutiesWithRun[0])===null||_dutiesWithRun$===void 0?void 0:_dutiesWithRun$.assignedDriver;setSelectedRun({code:runCode,color:runColor,currentDriver,dutyIds:dutiesWithRun.map(t=>t.dutyId)});setShowRunModal(true);};const handleBlockAssignment=async vehicleId=>{if(!selectedBlock)return;try{// Find the vehicle object if an ID was provided\nlet vehicle=null;let vehicleName=undefined;if(vehicleId){const allVehicles=await dataService.getVehicles({limit:1000});const foundVehicle=allVehicles.find(v=>v.id===vehicleId);if(foundVehicle){vehicle=foundVehicle;vehicleName=\"\".concat(foundVehicle.plateNo,\" - \").concat(foundVehicle.fleetNo);}}// Update all trips with this block code\nconst updatedTrips=trips.map(trip=>{if(selectedBlock.dutyIds.includes(trip.dutyId)){return _objectSpread(_objectSpread({},trip),{},{assignedVehicle:vehicleName,vehicleId:vehicleId||undefined,vehicle:vehicle,isModified:true,isNewlyAssigned:!trip.assignedVehicle&&vehicleName!==undefined});}return trip;});setTrips(updatedTrips);setFilteredTrips(updatedTrips);setHasUnsavedChanges(true);}catch(error){console.error('Error assigning vehicle to block:',error);alert('Failed to assign vehicle. Please try again.');}};const handleRunAssignment=async driverId=>{if(!selectedRun)return;try{// Find the driver object if an ID was provided\nlet driver=null;let driverName=undefined;if(driverId){const allDrivers=await dataService.getDrivers({limit:1000});const foundDriver=allDrivers.find(d=>d.id===driverId);if(foundDriver){driver=foundDriver;driverName=foundDriver.name;}}// Update all trips with this run code\nconst updatedTrips=trips.map(trip=>{if(selectedRun.dutyIds.includes(trip.dutyId)){return _objectSpread(_objectSpread({},trip),{},{assignedDriver:driverName,driverId:driverId||undefined,driver:driver,isModified:true,isNewlyAssigned:!trip.assignedDriver&&driverName!==undefined});}return trip;});setTrips(updatedTrips);setFilteredTrips(updatedTrips);setHasUnsavedChanges(true);}catch(error){console.error('Error assigning driver to run:',error);alert('Failed to assign driver. Please try again.');}};const formatTime=time=>{return time;};const getStatusLabel=status=>{switch(status){case'in-progress':return'In Progress';case'completed':return'Completed';default:return'Planned';}};const isAllSelected=filteredTrips.length>0&&selectedTrips.size===filteredTrips.length;const isIndeterminate=selectedTrips.size>0&&selectedTrips.size<filteredTrips.length;return/*#__PURE__*/_jsxs(PageContainer,{className:\"fade-in\",children:[/*#__PURE__*/_jsxs(PageHeader,{children:[/*#__PURE__*/_jsx(PageTitle,{children:\"Duty Assignment\"}),/*#__PURE__*/_jsx(HeaderActions,{children:/*#__PURE__*/_jsxs(Button,{onClick:handleCreateDuty,variant:\"primary\",children:[/*#__PURE__*/_jsx(FiPlus,{style:{marginRight:'8px'}}),\"Generate Duties\"]})})]}),/*#__PURE__*/_jsxs(AssignmentContainer,{children:[/*#__PURE__*/_jsxs(SelectionControls,{children:[/*#__PURE__*/_jsxs(DateSelector,{children:[/*#__PURE__*/_jsx(FiCalendar,{size:20,color:theme.colors.primary}),/*#__PURE__*/_jsxs(DateRangeContainer,{children:[/*#__PURE__*/_jsx(DateInput,{type:\"date\",value:selectedDateRange.startDate,onChange:e=>setSelectedDateRange(prev=>_objectSpread(_objectSpread({},prev),{},{startDate:e.target.value})),placeholder:\"Start Date\"}),/*#__PURE__*/_jsx(\"span\",{style:{color:theme.colors.textMuted},children:\"to\"}),/*#__PURE__*/_jsx(DateInput,{type:\"date\",value:selectedDateRange.endDate,onChange:e=>setSelectedDateRange(prev=>_objectSpread(_objectSpread({},prev),{},{endDate:e.target.value})),placeholder:\"End Date\"})]})]}),/*#__PURE__*/_jsx(SearchDropdownWrapper,{children:/*#__PURE__*/_jsx(MultiSelectSearchDropdown,{values:selectedRoutes,onChange:setSelectedRoutes,onSearch:async searchTerm=>{if(!searchTerm.trim())return routes;return routes.filter(route=>route.name.toLowerCase().includes(searchTerm.toLowerCase())||route.code.toLowerCase().includes(searchTerm.toLowerCase()));},displayValue:route=>route.name,renderItem:route=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'4px 0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'500',fontSize:'14px'},children:route.name}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'12px',color:'#6b7280',marginTop:'2px'},children:route.code})]}),placeholder:\"Search routes...\",disabled:routesLoading})}),/*#__PURE__*/_jsx(SearchDropdownWrapper,{children:/*#__PURE__*/_jsx(MultiSelectSearchDropdown,{values:selectedDrivers,onChange:setSelectedDrivers,onSearch:searchDrivers,displayValue:driver=>driver.name,renderItem:driver=>/*#__PURE__*/_jsxs(\"div\",{style:{padding:'4px 0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'500',fontSize:'14px'},children:driver.name}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#6b7280',marginTop:'2px'},children:[\"QID: \",driver.qid||'N/A']})]}),placeholder:\"Search drivers...\"})}),/*#__PURE__*/_jsx(SearchDropdownWrapper,{children:/*#__PURE__*/_jsx(MultiSelectSearchDropdown,{values:selectedVehicles,onChange:setSelectedVehicles,onSearch:searchVehicles,displayValue:vehicle=>\"\".concat(vehicle.plateNo,\" - \").concat(vehicle.fleetNo),renderItem:vehicle=>{var _vehicle$model,_vehicle$model2;return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'4px 0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'500',fontSize:'14px'},children:vehicle.plateNo}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'#6b7280',marginTop:'2px'},children:[\"Fleet: \",vehicle.fleetNo,\" \\u2022 \",((_vehicle$model=vehicle.model)===null||_vehicle$model===void 0?void 0:_vehicle$model.make)||'Unknown',\" \",((_vehicle$model2=vehicle.model)===null||_vehicle$model2===void 0?void 0:_vehicle$model2.year)||'']})]});},placeholder:\"Search vehicles...\"})}),/*#__PURE__*/_jsx(SearchDropdownWrapper,{children:/*#__PURE__*/_jsx(MultiSelectSearchDropdown,{values:selectedDutyTypes.map(type=>({id:type,name:type})),onChange:types=>setSelectedDutyTypes(types.map(t=>t.id)),onSearch:async searchTerm=>{const dutyTypes=['TRIP','WASHING','MAINTENANCE'];if(!searchTerm.trim())return dutyTypes.map(type=>({id:type,name:type}));return dutyTypes.filter(type=>type.toLowerCase().includes(searchTerm.toLowerCase())).map(type=>({id:type,name:type}));},displayValue:type=>type.name,renderItem:type=>/*#__PURE__*/_jsx(\"div\",{style:{padding:'4px 0'},children:/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'500',fontSize:'14px'},children:type.name})}),placeholder:\"Search duty types...\"})})]}),hasUnsavedChanges&&/*#__PURE__*/_jsxs(UnsavedChangesWarning,{children:[/*#__PURE__*/_jsxs(WarningText,{children:[/*#__PURE__*/_jsx(FiRefreshCw,{size:16}),\"You have unsaved changes. Save your changes to keep them.\"]}),/*#__PURE__*/_jsxs(ActionButtons,{children:[/*#__PURE__*/_jsx(DiscardButton,{onClick:handleDiscardChanges,children:\"Discard Changes\"}),/*#__PURE__*/_jsx(SaveButton,{onClick:handleSaveChanges,disabled:isSaving,children:isSaving?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{width:12,height:12,border:'2px solid white',borderTop:'2px solid transparent',borderRadius:'50%',animation:'spin 1s linear infinite'}}),\"Saving...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FiRefreshCw,{size:14}),\"Save Changes\"]})})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{style:{padding:theme.spacing.md,backgroundColor:theme.colors.error+'20',border:\"1px solid \".concat(theme.colors.error),borderRadius:theme.borderRadius.md,color:theme.colors.error,marginBottom:theme.spacing.lg},children:error}),loading?/*#__PURE__*/_jsx(LoadingState,{children:/*#__PURE__*/_jsx(\"p\",{children:\"Loading trips...\"})}):!(selectedRoutes.length>0||selectedDrivers.length>0||selectedVehicles.length>0||selectedDutyTypes.length>0)?/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(FiMap,{size:48,color:theme.colors.textMuted,style:{marginBottom:theme.spacing.lg}}),/*#__PURE__*/_jsx(\"h3\",{style:{color:theme.colors.textPrimary,marginBottom:theme.spacing.sm},children:\"Select a Filter\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Please select a route, driver, vehicle, or duty type to view and manage assignments\"})]}):filteredTrips.length===0?/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(FiMap,{size:48,color:theme.colors.textMuted,style:{marginBottom:theme.spacing.lg}}),/*#__PURE__*/_jsx(\"h3\",{style:{color:theme.colors.textPrimary,marginBottom:theme.spacing.sm},children:\"No Trips Found\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"No trips found for the selected filters from \",new Date(selectedDateRange.startDate).toLocaleDateString(),\" to \",new Date(selectedDateRange.endDate).toLocaleDateString()]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsxs(TableHeader,{children:[/*#__PURE__*/_jsx(TableHeaderCell,{children:/*#__PURE__*/_jsx(Checkbox,{type:\"checkbox\",checked:isAllSelected,ref:input=>{if(input)input.indeterminate=isIndeterminate;},onChange:handleSelectAll})}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Date\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Time\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Trip #\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Route\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Duty Type\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Vehicle Block\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Driver Run\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Driver\"}),/*#__PURE__*/_jsx(TableHeaderCell,{children:\"Vehicle\"})]}),/*#__PURE__*/_jsx(TableBody,{children:filteredTrips.map(trip=>/*#__PURE__*/_jsxs(ModifiedRow,{isModified:trip.isModified||false,isNewlyAssigned:trip.isNewlyAssigned||false,children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Checkbox,{type:\"checkbox\",checked:selectedTrips.has(trip.id),onChange:()=>handleSelectTrip(trip.id)})}),/*#__PURE__*/_jsx(TableCell,{children:trip.date}),/*#__PURE__*/_jsxs(TableCell,{children:[formatTime(trip.scheduledStartTime),\" - \",formatTime(trip.scheduledEndTime)]}),/*#__PURE__*/_jsx(TableCell,{children:trip.tripNumber}),/*#__PURE__*/_jsx(TableCell,{children:trip.routeName}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(\"span\",{style:{padding:'4px 8px',borderRadius:'4px',fontSize:'12px',fontWeight:'500',backgroundColor:trip.dutyType==='TRIP'?'#e3f2fd':trip.dutyType==='WASHING'?'#f3e5f5':'#fff3e0',color:trip.dutyType==='TRIP'?'#1976d2':trip.dutyType==='WASHING'?'#7b1fa2':'#f57c00'},children:trip.dutyType})}),/*#__PURE__*/_jsx(ColoredTableCell,{$bgColor:trip.vehicleBlockCode?trip.vehicleBlockColor:undefined,$clickable:true,onClick:()=>trip.vehicleBlockCode&&handleBlockClick(trip.vehicleBlockCode,trip.vehicleBlockColor),children:trip.vehicleBlockCode?/*#__PURE__*/_jsx(\"span\",{style:{fontFamily:'monospace',fontWeight:'600',color:trip.vehicleBlockColor||theme.colors.primary},children:trip.vehicleBlockCode}):/*#__PURE__*/_jsx(\"span\",{style:{color:theme.colors.textMuted,fontStyle:'italic'},children:\"-\"})}),/*#__PURE__*/_jsx(ColoredTableCell,{$bgColor:trip.driverRunCode?trip.driverRunColor:undefined,$clickable:true,onClick:()=>trip.driverRunCode&&handleRunClick(trip.driverRunCode,trip.driverRunColor),children:trip.driverRunCode?/*#__PURE__*/_jsx(\"span\",{style:{fontFamily:'monospace',fontWeight:'600',color:trip.driverRunColor||theme.colors.primary},children:trip.driverRunCode}):/*#__PURE__*/_jsx(\"span\",{style:{color:theme.colors.textMuted,fontStyle:'italic'},children:\"-\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(StatusIndicator,{isModified:trip.isModified||false,isNewlyAssigned:trip.isNewlyAssigned||false,children:trip.assignedDriver?/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:theme.spacing.xs},children:[/*#__PURE__*/_jsx(FiUsers,{size:14,color:theme.colors.success}),trip.assignedDriver]}):/*#__PURE__*/_jsx(\"span\",{style:{color:theme.colors.textMuted},children:\"Unassigned\"})})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(StatusIndicator,{isModified:trip.isModified||false,isNewlyAssigned:trip.isNewlyAssigned||false,children:trip.assignedVehicle?/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:theme.spacing.xs},children:[/*#__PURE__*/_jsx(FiTruck,{size:14,color:theme.colors.success}),trip.assignedVehicle]}):/*#__PURE__*/_jsx(\"span\",{style:{color:theme.colors.textMuted},children:\"Unassigned\"})})})]},trip.id))})]}),/*#__PURE__*/_jsxs(FloatingActionBar,{visible:selectedTrips.size>0,children:[/*#__PURE__*/_jsxs(SelectionCount,{children:[selectedTrips.size,\" trip\",selectedTrips.size!==1?'s':'',\" selected\"]}),/*#__PURE__*/_jsxs(AssignButton,{variant:\"primary\",onClick:handleAssign,children:[/*#__PURE__*/_jsx(FiUsers,{}),\"Assign\"]})]})]}),/*#__PURE__*/_jsx(AssignmentModal,{isOpen:showAssignmentModal,onClose:()=>setShowAssignmentModal(false),selectedTrips:Array.from(selectedTrips),onAssign:handleAssignmentComplete}),/*#__PURE__*/_jsx(BlockAssignmentModal,{isOpen:showBlockModal,onClose:()=>setShowBlockModal(false),blockCode:selectedBlock===null||selectedBlock===void 0?void 0:selectedBlock.code,blockColor:selectedBlock===null||selectedBlock===void 0?void 0:selectedBlock.color,currentVehicle:selectedBlock===null||selectedBlock===void 0?void 0:selectedBlock.currentVehicle,dutyCount:(selectedBlock===null||selectedBlock===void 0?void 0:selectedBlock.dutyIds.length)||0,onAssign:handleBlockAssignment}),/*#__PURE__*/_jsx(RunAssignmentModal,{isOpen:showRunModal,onClose:()=>setShowRunModal(false),runCode:selectedRun===null||selectedRun===void 0?void 0:selectedRun.code,runColor:selectedRun===null||selectedRun===void 0?void 0:selectedRun.color,currentDriver:selectedRun===null||selectedRun===void 0?void 0:selectedRun.currentDriver,dutyCount:(selectedRun===null||selectedRun===void 0?void 0:selectedRun.dutyIds.length)||0,onAssign:handleRunAssignment})]})]});};export default AssignmentInterface;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","FiCalendar","FiMap","FiUsers","FiTruck","FiRefreshCw","FiPlus","Button","PageContainer","PageHeader","PageTitle","HeaderActions","Table","TableHeader","TableHeaderCell","TableBody","TableCell","styled","theme","AssignmentModal","BlockAssignmentModal","RunAssignmentModal","MultiSelectSearchDropdown","dataService","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AssignmentContainer","div","_templateObject","_taggedTemplateLiteral","spacing","lg","SelectionControls","_templateObject2","md","DateSelector","_templateObject3","sm","DateRangeContainer","_templateObject4","DateInput","input","_templateObject5","colors","border","borderRadius","card","textPrimary","typography","fontSize","primary","SearchDropdownWrapper","_templateObject6","RouteSelect","select","_templateObject7","Checkbox","_templateObject8","FloatingActionBar","_templateObject9","xl","shadows","_ref","visible","zIndex","modal","SelectionCount","_templateObject0","fontWeight","medium","AssignButton","_templateObject1","EmptyState","_templateObject10","textSecondary","LoadingState","_templateObject11","UnsavedChangesWarning","_templateObject12","warning","WarningText","_templateObject13","ActionButtons","_templateObject14","SaveButton","button","_templateObject15","primaryHover","DiscardButton","_templateObject16","surfaceHover","ModifiedRow","tr","_templateObject17","props","isNewlyAssigned","concat","success","isModified","StatusIndicator","span","_templateObject18","xs","ColoredTableCell","_templateObject19","$bgColor","$clickable","AssignmentInterface","navigate","selectedDateRange","setSelectedDateRange","today","Date","startDate","toISOString","split","endDate","selectedRoutes","setSelectedRoutes","selectedDrivers","setSelectedDrivers","selectedVehicles","setSelectedVehicles","selectedDutyTypes","setSelectedDutyTypes","trips","setTrips","filteredTrips","setFilteredTrips","selectedTrips","setSelectedTrips","Set","loading","setLoading","showAssignmentModal","setShowAssignmentModal","hasUnsavedChanges","setHasUnsavedChanges","originalTrips","setOriginalTrips","isSaving","setIsSaving","showBlockModal","setShowBlockModal","showRunModal","setShowRunModal","selectedBlock","setSelectedBlock","selectedRun","setSelectedRun","routes","setRoutes","routesLoading","setRoutesLoading","error","setError","loadRoutes","routesData","getRoutes","console","hasFilter","length","loadTrips","searchDrivers","searchTerm","trim","getDrivers","search","limit","searchVehicles","getVehicles","queryParams","dutyType","routeIds","map","route","id","driverIds","driver","vehicleIds","vehicle","duties","getDuties","tripsData","sort","a","b","startTime","getTime","duty","index","_duty$tripDuties","_duty$tripDuties$","_duty$tripDuties$$rou","_duty$driver","_vehicleBlockTemplate","_driverRunTemplate","routeName","tripDuties","name","driverName","user","undefined","vehicleName","fleetNo","plateNo","block","run","vehicleBlockCode","code","driverRunCode","dutyId","tripNumber","String","padStart","date","toLocaleDateString","scheduledStartTime","toLocaleTimeString","hour","minute","hour12","scheduledEndTime","endTime","status","assignedDriver","assignedVehicle","driverId","vehicleId","vehicleBlockColor","vehicleBlockTemplate","color","driverRunColor","driverRunTemplate","originalAssignedDriver","originalAssignedVehicle","handleSelectTrip","tripId","newSelected","has","delete","add","handleSelectAll","size","trip","handleAssign","handleCreateDuty","handleAssignmentComplete","assignmentData","_assignmentData$selec","_assignmentData$selec2","log","Array","from","d","v","updatedTrips","tripIndex","indexOf","assignedDriverName","driverIndex","assignedVehicleName","vehicleIndex","_objectSpread","handleSaveChanges","modifiedTrips","filter","assignments","bulkUpdateDutyAssignments","alert","handleDiscardChanges","window","confirm","handleBlockClick","blockCode","blockColor","_dutiesWithBlock$","dutiesWithBlock","currentVehicle","dutyIds","t","handleRunClick","runCode","runColor","_dutiesWithRun$","dutiesWithRun","currentDriver","handleBlockAssignment","allVehicles","foundVehicle","find","includes","handleRunAssignment","allDrivers","foundDriver","formatTime","time","getStatusLabel","isAllSelected","isIndeterminate","className","children","onClick","variant","style","marginRight","type","value","onChange","e","prev","target","placeholder","textMuted","values","onSearch","toLowerCase","displayValue","renderItem","padding","marginTop","disabled","qid","_vehicle$model","_vehicle$model2","model","make","year","types","dutyTypes","width","height","borderTop","animation","backgroundColor","marginBottom","checked","ref","indeterminate","fontFamily","fontStyle","display","alignItems","gap","isOpen","onClose","onAssign","dutyCount"],"sources":["/home/mhmdal/Projects/moveo-master/moveo/src/pages/Duties/AssignmentInterface.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { FiCalendar, FiMap, FiCheck, FiUsers, FiTruck, FiRefreshCw, FiPlus } from 'react-icons/fi';\nimport { Button } from '../../styles/GlobalStyles';\nimport { \n  PageContainer,\n  PageHeader,\n  PageTitle,\n  HeaderActions,\n  SearchContainer,\n  SearchInput,\n  Table,\n  TableHeader,\n  TableHeaderCell,\n  TableBody,\n  TableRow,\n  TableCell\n} from '../../components/Common/CommonStyles';\nimport styled from 'styled-components';\nimport { theme } from '../../styles/theme';\nimport AssignmentModal from '../../components/Modals/AssignmentModal';\nimport BlockAssignmentModal from '../../components/Modals/BlockAssignmentModal';\nimport RunAssignmentModal from '../../components/Modals/RunAssignmentModal';\nimport MultiSelectSearchDropdown from '../../components/UI/DropDowns/MultiSelectSearchDropdown';\nimport { dataService } from '../../services/dataService';\nimport { Route, Duty, Driver, Vehicle } from '../../types';\n\nconst AssignmentContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: ${theme.spacing.lg};\n`;\n\nconst SelectionControls = styled.div`\n  display: flex;\n  gap: ${theme.spacing.md};\n  margin-bottom: ${theme.spacing.lg};\n  flex-wrap: nowrap;\n  align-items: center;\n  \n  @media (max-width: 1200px) {\n    flex-wrap: wrap;\n  }\n`;\n\nconst DateSelector = styled.div`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n  min-width: 300px;\n`;\n\nconst DateRangeContainer = styled.div`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n`;\n\nconst DateInput = styled.input`\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${theme.colors.card};\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n  \n  &:focus {\n    outline: none;\n    border-color: ${theme.colors.primary};\n  }\n`;\n\nconst SearchDropdownWrapper = styled.div`\n  min-width: 200px;\n  flex: 1;\n  max-width: 250px;\n`;\n\nconst RouteSelect = styled.select`\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.md};\n  background: ${theme.colors.card};\n  color: ${theme.colors.textPrimary};\n  font-size: ${theme.typography.fontSize.sm};\n  min-width: 200px;\n  \n  &:focus {\n    outline: none;\n    border-color: ${theme.colors.primary};\n  }\n`;\n\nconst Checkbox = styled.input`\n  width: 18px;\n  height: 18px;\n  accent-color: ${theme.colors.primary};\n`;\n\nconst FloatingActionBar = styled.div<{ visible: boolean }>`\n  position: fixed;\n  bottom: ${theme.spacing.xl};\n  right: ${theme.spacing.xl};\n  background: ${theme.colors.card};\n  border: 1px solid ${theme.colors.border};\n  border-radius: ${theme.borderRadius.lg};\n  padding: ${theme.spacing.lg};\n  box-shadow: ${theme.shadows.lg};\n  display: ${({ visible }) => visible ? 'flex' : 'none'};\n  align-items: center;\n  gap: ${theme.spacing.md};\n  z-index: ${theme.zIndex.modal};\n  transition: all 0.3s ease;\n`;\n\nconst SelectionCount = styled.div`\n  color: ${theme.colors.textPrimary};\n  font-weight: ${theme.typography.fontWeight.medium};\n`;\n\nconst AssignButton = styled(Button)`\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n`;\n\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: ${theme.spacing['3xl']};\n  color: ${theme.colors.textSecondary};\n`;\n\nconst LoadingState = styled.div`\n  text-align: center;\n  padding: ${theme.spacing.xl};\n  color: ${theme.colors.textSecondary};\n`;\n\nconst UnsavedChangesWarning = styled.div`\n  background: ${theme.colors.warning}20;\n  border: 1px solid ${theme.colors.warning};\n  border-radius: ${theme.borderRadius.md};\n  padding: ${theme.spacing.md};\n  margin-bottom: ${theme.spacing.lg};\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: ${theme.spacing.md};\n`;\n\nconst WarningText = styled.div`\n  color: ${theme.colors.warning};\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n`;\n\nconst ActionButtons = styled.div`\n  display: flex;\n  gap: ${theme.spacing.sm};\n`;\n\nconst SaveButton = styled.button`\n  background: ${theme.colors.primary};\n  color: white;\n  border: none;\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border-radius: ${theme.borderRadius.md};\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: ${theme.spacing.sm};\n\n  &:hover:not(:disabled) {\n    background: ${theme.colors.primaryHover};\n  }\n\n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n  }\n`;\n\nconst DiscardButton = styled.button`\n  background: transparent;\n  color: ${theme.colors.textSecondary};\n  border: 1px solid ${theme.colors.border};\n  padding: ${theme.spacing.sm} ${theme.spacing.md};\n  border-radius: ${theme.borderRadius.md};\n  font-size: ${theme.typography.fontSize.sm};\n  font-weight: ${theme.typography.fontWeight.medium};\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: ${theme.colors.surfaceHover};\n    border-color: ${theme.colors.textSecondary};\n  }\n`;\n\nconst ModifiedRow = styled.tr<{ isModified: boolean; isNewlyAssigned: boolean }>`\n  background: ${props => {\n    if (props.isNewlyAssigned) return `${theme.colors.success}15`;\n    if (props.isModified) return `${theme.colors.warning}15`;\n    return 'transparent';\n  }};\n  border-left: 3px solid ${props => {\n    if (props.isNewlyAssigned) return theme.colors.success;\n    if (props.isModified) return theme.colors.warning;\n    return 'transparent';\n  }};\n`;\n\nconst StatusIndicator = styled.span<{ isModified: boolean; isNewlyAssigned: boolean }>`\n  display: inline-flex;\n  align-items: center;\n  gap: ${theme.spacing.xs};\n  \n  &::before {\n    content: '';\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: ${props => {\n      if (props.isNewlyAssigned) return theme.colors.success;\n      if (props.isModified) return theme.colors.warning;\n      return 'transparent';\n    }};\n  }\n`;\n\nconst ColoredTableCell = styled(TableCell)<{ $bgColor?: string; $clickable?: boolean }>`\n  background: ${props => props.$bgColor ? `color-mix(in srgb, ${props.$bgColor} 15%, transparent)` : 'transparent'};\n  border-left: ${props => props.$bgColor ? `3px solid ${props.$bgColor}` : 'none'};\n  transition: all 0.2s ease;\n  cursor: ${props => props.$clickable ? 'pointer' : 'default'};\n  \n  ${props => props.$bgColor && `\n    &:hover {\n      background: color-mix(in srgb, ${props.$bgColor} 25%, transparent);\n    }\n  `}\n  \n  ${props => props.$clickable && !props.$bgColor && `\n    &:hover {\n      background: ${theme.colors.surfaceHover};\n    }\n  `}\n`;\n\ninterface Trip {\n  id: string;\n  tripNumber: string;\n  routeName: string;\n  date: string;\n  scheduledStartTime: string;\n  scheduledEndTime: string;\n  status: 'planned' | 'in-progress' | 'completed';\n  assignedDriver?: string;\n  assignedVehicle?: string;\n  dutyType: string;\n  // Assignment tracking\n  originalAssignedDriver?: string;\n  originalAssignedVehicle?: string;\n  isModified?: boolean;\n  isNewlyAssigned?: boolean;\n  // Duty-specific fields\n  dutyId: string;\n  driverId?: string;\n  vehicleId?: string;\n  driver?: any; // Will be the actual driver object from API\n  vehicle?: any; // Will be the actual vehicle object from API\n  // Block and Run codes\n  vehicleBlockCode?: string;\n  vehicleBlockColor?: string;\n  driverRunCode?: string;\n  driverRunColor?: string;\n}\n\nconst AssignmentInterface: React.FC = () => {\n  const navigate = useNavigate();\n  const [selectedDateRange, setSelectedDateRange] = useState(() => {\n    const today = new Date();\n    return {\n      startDate: today.toISOString().split('T')[0],\n      endDate: today.toISOString().split('T')[0]\n    };\n  });\n  const [selectedRoutes, setSelectedRoutes] = useState<Route[]>([]);\n  const [selectedDrivers, setSelectedDrivers] = useState<Driver[]>([]);\n  const [selectedVehicles, setSelectedVehicles] = useState<Vehicle[]>([]);\n  const [selectedDutyTypes, setSelectedDutyTypes] = useState<string[]>([]);\n  const [trips, setTrips] = useState<Trip[]>([]);\n  const [filteredTrips, setFilteredTrips] = useState<Trip[]>([]);\n  const [selectedTrips, setSelectedTrips] = useState<Set<string>>(new Set());\n  const [loading, setLoading] = useState(false);\n  const [showAssignmentModal, setShowAssignmentModal] = useState(false);\n  \n  // State management for changes\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n  const [originalTrips, setOriginalTrips] = useState<Trip[]>([]);\n  const [isSaving, setIsSaving] = useState(false);\n  \n  // Block and Run assignment modals\n  const [showBlockModal, setShowBlockModal] = useState(false);\n  const [showRunModal, setShowRunModal] = useState(false);\n  const [selectedBlock, setSelectedBlock] = useState<{\n    code: string;\n    color?: string;\n    currentVehicle?: string;\n    dutyIds: string[];\n  } | null>(null);\n  const [selectedRun, setSelectedRun] = useState<{\n    code: string;\n    color?: string;\n    currentDriver?: string;\n    dutyIds: string[];\n  } | null>(null);\n  \n  // Routes state\n  const [routes, setRoutes] = useState<Route[]>([]);\n  const [routesLoading, setRoutesLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load routes on component mount\n  useEffect(() => {\n    const loadRoutes = async () => {\n      try {\n        setRoutesLoading(true);\n        setError(null);\n        const routesData = await dataService.getRoutes();\n        setRoutes(routesData);\n      } catch (error) {\n        console.error('Error loading routes:', error);\n        setError('Failed to load routes. Please try again.');\n      } finally {\n        setRoutesLoading(false);\n      }\n    };\n\n    loadRoutes();\n  }, []);\n\n  useEffect(() => {\n    // Check if at least one filter is selected\n    const hasFilter = selectedDateRange.startDate && selectedDateRange.endDate && \n      (selectedRoutes.length > 0 || selectedDrivers.length > 0 || selectedVehicles.length > 0 || selectedDutyTypes.length > 0);\n    \n    if (hasFilter) {\n      loadTrips();\n    } else {\n      setTrips([]);\n      setFilteredTrips([]);\n    }\n  }, [selectedDateRange, selectedRoutes, selectedDrivers, selectedVehicles, selectedDutyTypes]);\n\n  useEffect(() => {\n    setSelectedTrips(new Set()); // Clear selection when trips change\n  }, [trips]);\n\n  // Search functions for SearchDropdown components\n  const searchDrivers = async (searchTerm: string): Promise<Driver[]> => {\n    try {\n      if (!searchTerm.trim()) {\n        return [];\n      }\n      return await dataService.getDrivers({\n        search: searchTerm.trim(),\n        limit: 50\n      });\n    } catch (error) {\n      console.error('Error searching drivers:', error);\n      return [];\n    }\n  };\n\n  const searchVehicles = async (searchTerm: string): Promise<Vehicle[]> => {\n    try {\n      if (!searchTerm.trim()) {\n        return [];\n      }\n      return await dataService.getVehicles({\n        search: searchTerm.trim(),\n        limit: 50\n      });\n    } catch (error) {\n      console.error('Error searching vehicles:', error);\n      return [];\n    }\n  };\n\n  const loadTrips = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      // Build query parameters for backend filtering\n      const queryParams: any = {\n        startDate: selectedDateRange.startDate,\n        endDate: selectedDateRange.endDate\n      };\n      \n      // Add duty type filter\n      if (selectedDutyTypes.length > 0) {\n        queryParams.dutyType = selectedDutyTypes[0]; // Backend currently supports single duty type\n      } else {\n        queryParams.dutyType = 'TRIP'; // Default to TRIP if no duty type selected\n      }\n      \n      // Add multi-select filters to backend query\n      if (selectedRoutes.length > 0) {\n        queryParams.routeIds = selectedRoutes.map(route => route.id);\n      }\n      \n      if (selectedDrivers.length > 0) {\n        queryParams.driverIds = selectedDrivers.map(driver => driver.id);\n      }\n      \n      if (selectedVehicles.length > 0) {\n        queryParams.vehicleIds = selectedVehicles.map(vehicle => vehicle.id);\n      }\n      \n      const duties = await dataService.getDuties(queryParams);\n      \n      // Convert duties to trips format and sort by start time\n      const tripsData: Trip[] = duties\n        .sort((a, b) => new Date(a.startTime).getTime() - new Date(b.startTime).getTime()) // Sort duties by start time first\n        .map((duty, index) => {\n          const routeName = duty.dutyType === 'TRIP' \n            ? (duty.tripDuties?.[0]?.route?.name || 'Unknown Route')\n            : '-';\n          const driverName = (duty.driver as any)?.user ? `${(duty.driver as any).user.name}` : undefined;\n          const vehicleName = duty.vehicle ? `${(duty.vehicle as any).fleetNo || ''} - ${(duty.vehicle as any).plateNo || ''}`.trim() : undefined;\n          \n          // Extract block and run codes\n          const block = (duty as any).block;\n          const run = (duty as any).run;\n          const vehicleBlockCode = block?.code; // Remove date suffix\n          const driverRunCode = run?.code; // Remove date suffix\n          \n          return {\n            id: duty.id,\n            dutyId: duty.id,\n            tripNumber: `T-${String(index + 1).padStart(3, '0')}`,\n            routeName,\n            date: new Date(duty.startTime).toLocaleDateString(),\n            scheduledStartTime: new Date(duty.startTime).toLocaleTimeString('en-US', { \n              hour: '2-digit', \n              minute: '2-digit',\n              hour12: false \n            }),\n            scheduledEndTime: new Date(duty.endTime).toLocaleTimeString('en-US', { \n              hour: '2-digit', \n              minute: '2-digit',\n              hour12: false \n            }),\n            status: 'planned' as const,\n            assignedDriver: driverName,\n            assignedVehicle: vehicleName,\n            dutyType: duty.dutyType,\n            driverId: duty.driverId,\n            vehicleId: duty.vehicleId,\n            driver: duty.driver,\n            vehicle: duty.vehicle,\n            vehicleBlockCode: vehicleBlockCode,\n            vehicleBlockColor: (block as any)?.vehicleBlockTemplate?.color,\n            driverRunCode: driverRunCode,\n            driverRunColor: (run as any)?.driverRunTemplate?.color,\n            // Initialize tracking fields\n            originalAssignedDriver: driverName,\n            originalAssignedVehicle: vehicleName,\n            isModified: false,\n            isNewlyAssigned: false\n          };\n        });\n      \n      setTrips(tripsData);\n      setFilteredTrips(tripsData);\n      setOriginalTrips([...tripsData]); // Store original data\n      setHasUnsavedChanges(false); // Reset change tracking\n    } catch (error) {\n      console.error('Error loading trips:', error);\n      setError('Failed to load trip duties. Please try again.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSelectTrip = (tripId: string) => {\n    const newSelected = new Set(selectedTrips);\n    if (newSelected.has(tripId)) {\n      newSelected.delete(tripId);\n    } else {\n      newSelected.add(tripId);\n    }\n    setSelectedTrips(newSelected);\n  };\n\n  const handleSelectAll = () => {\n    if (selectedTrips.size === filteredTrips.length) {\n      setSelectedTrips(new Set());\n    } else {\n      setSelectedTrips(new Set(filteredTrips.map(trip => trip.id)));\n    }\n  };\n\n  const handleAssign = () => {\n    setShowAssignmentModal(true);\n  };\n\n  const handleCreateDuty = () => {\n    navigate('/duties/create');\n  };\n\n  const handleAssignmentComplete = (assignmentData: any) => {\n    console.log('Assignment data:', assignmentData);\n    console.log('Selected trips:', Array.from(selectedTrips));\n    console.log('Selected drivers:', assignmentData.selectedDrivers?.map((d: any) => d.name) || []);\n    console.log('Selected vehicles:', assignmentData.selectedVehicles?.map((v: any) => `${v.plateNo} - ${v.fleetNo}`) || []);\n    \n    // Apply assignments to selected trips\n    const updatedTrips = trips.map(trip => {\n      if (selectedTrips.has(trip.id)) {\n        const tripIndex = Array.from(selectedTrips).indexOf(trip.id);\n        \n        // Handle driver assignment (if drivers are selected)\n        let assignedDriver = null;\n        let driverId = trip.driverId;\n        let driver = trip.driver;\n        let assignedDriverName = trip.assignedDriver;\n        \n        if (assignmentData.selectedDrivers.length > 0) {\n          const driverIndex = tripIndex % assignmentData.selectedDrivers.length;\n          assignedDriver = assignmentData.selectedDrivers[driverIndex];\n          driverId = assignedDriver.id;\n          driver = assignedDriver;\n          assignedDriverName = assignedDriver.name;\n        }\n        \n        // Handle vehicle assignment (if vehicles are selected)\n        let assignedVehicle = null;\n        let vehicleId = trip.vehicleId;\n        let vehicle = trip.vehicle;\n        let assignedVehicleName = trip.assignedVehicle;\n        \n        if (assignmentData.selectedVehicles.length > 0) {\n          const vehicleIndex = tripIndex % assignmentData.selectedVehicles.length;\n          assignedVehicle = assignmentData.selectedVehicles[vehicleIndex];\n          vehicleId = assignedVehicle.id;\n          vehicle = assignedVehicle;\n          assignedVehicleName = `${assignedVehicle.plateNo} - ${assignedVehicle.fleetNo}`;\n        }\n        \n        return {\n          ...trip,\n          assignedDriver: assignedDriverName,\n          assignedVehicle: assignedVehicleName,\n          driverId: driverId,\n          vehicleId: vehicleId,\n          driver: driver,\n          vehicle: vehicle,\n          isModified: true,\n          isNewlyAssigned: !trip.assignedDriver && !trip.assignedVehicle\n        };\n      }\n      return trip;\n    });\n    \n    setTrips(updatedTrips);\n    setFilteredTrips(updatedTrips);\n    setHasUnsavedChanges(true);\n    setSelectedTrips(new Set()); // Clear selection after assignment\n  };\n\n  const handleSaveChanges = async () => {\n    try {\n      setIsSaving(true);\n      \n      // Get modified trips\n      const modifiedTrips = trips.filter(trip => trip.isModified);\n      \n      if (modifiedTrips.length === 0) {\n        console.log('No changes to save');\n        return;\n      }\n      \n      // Prepare assignments for bulk update\n      const assignments = modifiedTrips.map(trip => ({\n        dutyId: trip.dutyId,\n        driverId: trip.driverId,\n        vehicleId: trip.vehicleId\n      }));\n      \n      // Call bulk update API\n      await dataService.bulkUpdateDutyAssignments({ assignments });\n      \n      // Update all trips to reflect saved state\n      const updatedTrips = trips.map(trip => ({\n        ...trip,\n        originalAssignedDriver: trip.assignedDriver,\n        originalAssignedVehicle: trip.assignedVehicle,\n        isModified: false,\n        isNewlyAssigned: false\n      }));\n      \n      setTrips(updatedTrips);\n      setFilteredTrips(updatedTrips);\n      setOriginalTrips(updatedTrips);\n      setHasUnsavedChanges(false);\n      \n      console.log('Changes saved successfully');\n    } catch (error) {\n      console.error('Error saving changes:', error);\n      alert('Failed to save changes. Please try again.');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleDiscardChanges = () => {\n    if (window.confirm('Are you sure you want to discard all unsaved changes?')) {\n      setTrips([...originalTrips]);\n      setFilteredTrips([...originalTrips]);\n      setHasUnsavedChanges(false);\n      setSelectedTrips(new Set());\n    }\n  };\n\n  const handleBlockClick = (blockCode: string, blockColor?: string) => {\n    // Find all duties with this block code\n    const dutiesWithBlock = trips.filter(trip => trip.vehicleBlockCode === blockCode);\n    \n    if (dutiesWithBlock.length === 0) return;\n    \n    // Get current vehicle assignment (they should all be the same for a block)\n    const currentVehicle = dutiesWithBlock[0]?.assignedVehicle;\n    \n    setSelectedBlock({\n      code: blockCode,\n      color: blockColor,\n      currentVehicle,\n      dutyIds: dutiesWithBlock.map(t => t.dutyId)\n    });\n    setShowBlockModal(true);\n  };\n\n  const handleRunClick = (runCode: string, runColor?: string) => {\n    // Find all duties with this run code\n    const dutiesWithRun = trips.filter(trip => trip.driverRunCode === runCode);\n    \n    if (dutiesWithRun.length === 0) return;\n    \n    // Get current driver assignment (they should all be the same for a run)\n    const currentDriver = dutiesWithRun[0]?.assignedDriver;\n    \n    setSelectedRun({\n      code: runCode,\n      color: runColor,\n      currentDriver,\n      dutyIds: dutiesWithRun.map(t => t.dutyId)\n    });\n    setShowRunModal(true);\n  };\n\n  const handleBlockAssignment = async (vehicleId: string | null) => {\n    if (!selectedBlock) return;\n\n    try {\n      // Find the vehicle object if an ID was provided\n      let vehicle: Vehicle | null = null;\n      let vehicleName: string | undefined = undefined;\n      \n      if (vehicleId) {\n        const allVehicles = await dataService.getVehicles({ limit: 1000 });\n        const foundVehicle = allVehicles.find(v => v.id === vehicleId);\n        if (foundVehicle) {\n          vehicle = foundVehicle;\n          vehicleName = `${foundVehicle.plateNo} - ${foundVehicle.fleetNo}`;\n        }\n      }\n\n      // Update all trips with this block code\n      const updatedTrips = trips.map(trip => {\n        if (selectedBlock.dutyIds.includes(trip.dutyId)) {\n          return {\n            ...trip,\n            assignedVehicle: vehicleName,\n            vehicleId: vehicleId || undefined,\n            vehicle: vehicle,\n            isModified: true,\n            isNewlyAssigned: !trip.assignedVehicle && vehicleName !== undefined\n          };\n        }\n        return trip;\n      });\n\n      setTrips(updatedTrips);\n      setFilteredTrips(updatedTrips);\n      setHasUnsavedChanges(true);\n    } catch (error) {\n      console.error('Error assigning vehicle to block:', error);\n      alert('Failed to assign vehicle. Please try again.');\n    }\n  };\n\n  const handleRunAssignment = async (driverId: string | null) => {\n    if (!selectedRun) return;\n\n    try {\n      // Find the driver object if an ID was provided\n      let driver: Driver | null = null;\n      let driverName: string | undefined = undefined;\n      \n      if (driverId) {\n        const allDrivers = await dataService.getDrivers({ limit: 1000 });\n        const foundDriver = allDrivers.find(d => d.id === driverId);\n        if (foundDriver) {\n          driver = foundDriver;\n          driverName = foundDriver.name;\n        }\n      }\n\n      // Update all trips with this run code\n      const updatedTrips = trips.map(trip => {\n        if (selectedRun.dutyIds.includes(trip.dutyId)) {\n          return {\n            ...trip,\n            assignedDriver: driverName,\n            driverId: driverId || undefined,\n            driver: driver,\n            isModified: true,\n            isNewlyAssigned: !trip.assignedDriver && driverName !== undefined\n          };\n        }\n        return trip;\n      });\n\n      setTrips(updatedTrips);\n      setFilteredTrips(updatedTrips);\n      setHasUnsavedChanges(true);\n    } catch (error) {\n      console.error('Error assigning driver to run:', error);\n      alert('Failed to assign driver. Please try again.');\n    }\n  };\n\n  const formatTime = (time: string) => {\n    return time;\n  };\n\n  const getStatusLabel = (status: string) => {\n    switch (status) {\n      case 'in-progress':\n        return 'In Progress';\n      case 'completed':\n        return 'Completed';\n      default:\n        return 'Planned';\n    }\n  };\n\n  const isAllSelected = filteredTrips.length > 0 && selectedTrips.size === filteredTrips.length;\n  const isIndeterminate = selectedTrips.size > 0 && selectedTrips.size < filteredTrips.length;\n\n\n  return (\n    <PageContainer className=\"fade-in\">\n      <PageHeader>\n        <PageTitle>Duty Assignment</PageTitle>\n        <HeaderActions>\n          <Button onClick={handleCreateDuty} variant=\"primary\">\n            <FiPlus style={{ marginRight: '8px' }} />\n            Generate Duties\n          </Button>\n        </HeaderActions>\n      </PageHeader>\n\n      <AssignmentContainer>\n      <SelectionControls>\n        <DateSelector>\n          <FiCalendar size={20} color={theme.colors.primary} />\n          <DateRangeContainer>\n            <DateInput\n              type=\"date\"\n              value={selectedDateRange.startDate}\n              onChange={(e) => setSelectedDateRange(prev => ({ ...prev, startDate: e.target.value }))}\n              placeholder=\"Start Date\"\n            />\n            <span style={{ color: theme.colors.textMuted }}>to</span>\n            <DateInput\n              type=\"date\"\n              value={selectedDateRange.endDate}\n              onChange={(e) => setSelectedDateRange(prev => ({ ...prev, endDate: e.target.value }))}\n              placeholder=\"End Date\"\n            />\n          </DateRangeContainer>\n        </DateSelector>\n\n        <SearchDropdownWrapper>\n          <MultiSelectSearchDropdown\n            values={selectedRoutes}\n            onChange={setSelectedRoutes}\n            onSearch={async (searchTerm) => {\n              if (!searchTerm.trim()) return routes;\n              return routes.filter(route => \n                route.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                route.code.toLowerCase().includes(searchTerm.toLowerCase())\n              );\n            }}\n            displayValue={(route) => route.name}\n            renderItem={(route) => (\n              <div style={{ padding: '4px 0' }}>\n                <div style={{ fontWeight: '500', fontSize: '14px' }}>\n                  {route.name}\n                </div>\n                <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '2px' }}>\n                  {route.code}\n                </div>\n              </div>\n            )}\n            placeholder=\"Search routes...\"\n            disabled={routesLoading}\n          />\n        </SearchDropdownWrapper>\n\n        <SearchDropdownWrapper>\n          <MultiSelectSearchDropdown\n            values={selectedDrivers}\n            onChange={setSelectedDrivers}\n            onSearch={searchDrivers}\n            displayValue={(driver) => driver.name}\n            renderItem={(driver) => (\n              <div style={{ padding: '4px 0' }}>\n                <div style={{ fontWeight: '500', fontSize: '14px' }}>\n                  {driver.name}\n                </div>\n                <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '2px' }}>\n                  QID: {driver.qid || 'N/A'}\n                </div>\n              </div>\n            )}\n            placeholder=\"Search drivers...\"\n          />\n        </SearchDropdownWrapper>\n\n        <SearchDropdownWrapper>\n          <MultiSelectSearchDropdown\n            values={selectedVehicles}\n            onChange={setSelectedVehicles}\n            onSearch={searchVehicles}\n            displayValue={(vehicle) => `${vehicle.plateNo} - ${vehicle.fleetNo}`}\n            renderItem={(vehicle) => (\n              <div style={{ padding: '4px 0' }}>\n                <div style={{ fontWeight: '500', fontSize: '14px' }}>\n                  {vehicle.plateNo}\n                </div>\n                <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '2px' }}>\n                  Fleet: {vehicle.fleetNo}  {vehicle.model?.make || 'Unknown'} {vehicle.model?.year || ''}\n                </div>\n              </div>\n            )}\n            placeholder=\"Search vehicles...\"\n          />\n        </SearchDropdownWrapper>\n\n        <SearchDropdownWrapper>\n          <MultiSelectSearchDropdown\n            values={selectedDutyTypes.map(type => ({ id: type, name: type }))}\n            onChange={(types) => setSelectedDutyTypes(types.map(t => t.id))}\n            onSearch={async (searchTerm) => {\n              const dutyTypes = ['TRIP', 'WASHING', 'MAINTENANCE'];\n              if (!searchTerm.trim()) return dutyTypes.map(type => ({ id: type, name: type }));\n              return dutyTypes\n                .filter(type => type.toLowerCase().includes(searchTerm.toLowerCase()))\n                .map(type => ({ id: type, name: type }));\n            }}\n            displayValue={(type) => type.name}\n            renderItem={(type) => (\n              <div style={{ padding: '4px 0' }}>\n                <div style={{ fontWeight: '500', fontSize: '14px' }}>\n                  {type.name}\n                </div>\n              </div>\n            )}\n            placeholder=\"Search duty types...\"\n          />\n        </SearchDropdownWrapper>\n      </SelectionControls>\n\n      {hasUnsavedChanges && (\n        <UnsavedChangesWarning>\n          <WarningText>\n            <FiRefreshCw size={16} />\n            You have unsaved changes. Save your changes to keep them.\n          </WarningText>\n          <ActionButtons>\n            <DiscardButton onClick={handleDiscardChanges}>\n              Discard Changes\n            </DiscardButton>\n            <SaveButton onClick={handleSaveChanges} disabled={isSaving}>\n              {isSaving ? (\n                <>\n                  <div style={{ width: 12, height: 12, border: '2px solid white', borderTop: '2px solid transparent', borderRadius: '50%', animation: 'spin 1s linear infinite' }} />\n                  Saving...\n                </>\n              ) : (\n                <>\n                  <FiRefreshCw size={14} />\n                  Save Changes\n                </>\n              )}\n            </SaveButton>\n          </ActionButtons>\n        </UnsavedChangesWarning>\n      )}\n\n      {error && (\n        <div style={{\n          padding: theme.spacing.md,\n          backgroundColor: theme.colors.error + '20',\n          border: `1px solid ${theme.colors.error}`,\n          borderRadius: theme.borderRadius.md,\n          color: theme.colors.error,\n          marginBottom: theme.spacing.lg\n        }}>\n          {error}\n        </div>\n      )}\n\n      {loading ? (\n        <LoadingState>\n          <p>Loading trips...</p>\n        </LoadingState>\n      ) : !(selectedRoutes.length > 0 || selectedDrivers.length > 0 || selectedVehicles.length > 0 || selectedDutyTypes.length > 0) ? (\n        <EmptyState>\n          <FiMap size={48} color={theme.colors.textMuted} style={{ marginBottom: theme.spacing.lg }} />\n          <h3 style={{ color: theme.colors.textPrimary, marginBottom: theme.spacing.sm }}>\n            Select a Filter\n          </h3>\n          <p>Please select a route, driver, vehicle, or duty type to view and manage assignments</p>\n        </EmptyState>\n      ) : filteredTrips.length === 0 ? (\n        <EmptyState>\n          <FiMap size={48} color={theme.colors.textMuted} style={{ marginBottom: theme.spacing.lg }} />\n          <h3 style={{ color: theme.colors.textPrimary, marginBottom: theme.spacing.sm }}>\n            No Trips Found\n          </h3>\n          <p>No trips found for the selected filters from {new Date(selectedDateRange.startDate).toLocaleDateString()} to {new Date(selectedDateRange.endDate).toLocaleDateString()}</p>\n        </EmptyState>\n      ) : (\n        <>\n          <Table>\n            <TableHeader>\n              <TableHeaderCell>\n                <Checkbox\n                  type=\"checkbox\"\n                  checked={isAllSelected}\n                  ref={(input) => {\n                    if (input) input.indeterminate = isIndeterminate;\n                  }}\n                  onChange={handleSelectAll}\n                />\n              </TableHeaderCell>\n              <TableHeaderCell>Date</TableHeaderCell>\n              <TableHeaderCell>Time</TableHeaderCell>\n              <TableHeaderCell>Trip #</TableHeaderCell>\n              <TableHeaderCell>Route</TableHeaderCell>\n              <TableHeaderCell>Duty Type</TableHeaderCell>\n              <TableHeaderCell>Vehicle Block</TableHeaderCell>\n              <TableHeaderCell>Driver Run</TableHeaderCell>\n              <TableHeaderCell>Driver</TableHeaderCell>\n              <TableHeaderCell>Vehicle</TableHeaderCell>\n            </TableHeader>\n            <TableBody>\n              {filteredTrips.map((trip) => (\n                <ModifiedRow \n                  key={trip.id} \n                  isModified={trip.isModified || false} \n                  isNewlyAssigned={trip.isNewlyAssigned || false}\n                >\n                  <TableCell>\n                    <Checkbox\n                      type=\"checkbox\"\n                      checked={selectedTrips.has(trip.id)}\n                      onChange={() => handleSelectTrip(trip.id)}\n                    />\n                  </TableCell>\n                  <TableCell>{trip.date}</TableCell>\n                  <TableCell>\n                    {formatTime(trip.scheduledStartTime)} - {formatTime(trip.scheduledEndTime)}\n                  </TableCell>\n                  <TableCell>{trip.tripNumber}</TableCell>\n                  <TableCell>{trip.routeName}</TableCell>\n                  <TableCell>\n                    <span style={{ \n                      padding: '4px 8px', \n                      borderRadius: '4px', \n                      fontSize: '12px',\n                      fontWeight: '500',\n                      backgroundColor: trip.dutyType === 'TRIP' ? '#e3f2fd' : trip.dutyType === 'WASHING' ? '#f3e5f5' : '#fff3e0',\n                      color: trip.dutyType === 'TRIP' ? '#1976d2' : trip.dutyType === 'WASHING' ? '#7b1fa2' : '#f57c00'\n                    }}>\n                      {trip.dutyType}\n                    </span>\n                  </TableCell>\n                  <ColoredTableCell \n                    $bgColor={trip.vehicleBlockCode ? trip.vehicleBlockColor : undefined}\n                    $clickable={true}\n                    onClick={() => trip.vehicleBlockCode && handleBlockClick(trip.vehicleBlockCode, trip.vehicleBlockColor)}\n                  >\n                    {trip.vehicleBlockCode ? (\n                      <span style={{ \n                        fontFamily: 'monospace', \n                        fontWeight: '600',\n                        color: trip.vehicleBlockColor || theme.colors.primary\n                      }}>\n                        {trip.vehicleBlockCode}\n                      </span>\n                    ) : (\n                      <span style={{ color: theme.colors.textMuted, fontStyle: 'italic' }}>\n                        -\n                      </span>\n                    )}\n                  </ColoredTableCell>\n                  <ColoredTableCell \n                    $bgColor={trip.driverRunCode ? trip.driverRunColor : undefined}\n                    $clickable={true}\n                    onClick={() => trip.driverRunCode && handleRunClick(trip.driverRunCode, trip.driverRunColor)}\n                  >\n                    {trip.driverRunCode ? (\n                      <span style={{ \n                        fontFamily: 'monospace', \n                        fontWeight: '600',\n                        color: trip.driverRunColor || theme.colors.primary\n                      }}>\n                        {trip.driverRunCode}\n                      </span>\n                    ) : (\n                      <span style={{ color: theme.colors.textMuted, fontStyle: 'italic' }}>\n                        -\n                      </span>\n                    )}\n                  </ColoredTableCell>\n                  <TableCell>\n                    <StatusIndicator isModified={trip.isModified || false} isNewlyAssigned={trip.isNewlyAssigned || false}>\n                      {trip.assignedDriver ? (\n                        <div style={{ display: 'flex', alignItems: 'center', gap: theme.spacing.xs }}>\n                          <FiUsers size={14} color={theme.colors.success} />\n                          {trip.assignedDriver}\n                        </div>\n                      ) : (\n                        <span style={{ color: theme.colors.textMuted }}>Unassigned</span>\n                      )}\n                    </StatusIndicator>\n                  </TableCell>\n                  <TableCell>\n                    <StatusIndicator isModified={trip.isModified || false} isNewlyAssigned={trip.isNewlyAssigned || false}>\n                      {trip.assignedVehicle ? (\n                        <div style={{ display: 'flex', alignItems: 'center', gap: theme.spacing.xs }}>\n                          <FiTruck size={14} color={theme.colors.success} />\n                          {trip.assignedVehicle}\n                        </div>\n                      ) : (\n                        <span style={{ color: theme.colors.textMuted }}>Unassigned</span>\n                      )}\n                    </StatusIndicator>\n                  </TableCell>\n                </ModifiedRow>\n              ))}\n            </TableBody>\n          </Table>\n\n          <FloatingActionBar visible={selectedTrips.size > 0}>\n            <SelectionCount>\n              {selectedTrips.size} trip{selectedTrips.size !== 1 ? 's' : ''} selected\n            </SelectionCount>\n            <AssignButton variant=\"primary\" onClick={handleAssign}>\n              <FiUsers />\n              Assign\n            </AssignButton>\n          </FloatingActionBar>\n        </>\n      )}\n\n      <AssignmentModal\n        isOpen={showAssignmentModal}\n        onClose={() => setShowAssignmentModal(false)}\n        selectedTrips={Array.from(selectedTrips)}\n        onAssign={handleAssignmentComplete}\n      />\n\n      <BlockAssignmentModal\n        isOpen={showBlockModal}\n        onClose={() => setShowBlockModal(false)}\n        blockCode={selectedBlock?.code}\n        blockColor={selectedBlock?.color}\n        currentVehicle={selectedBlock?.currentVehicle}\n        dutyCount={selectedBlock?.dutyIds.length || 0}\n        onAssign={handleBlockAssignment}\n      />\n\n      <RunAssignmentModal\n        isOpen={showRunModal}\n        onClose={() => setShowRunModal(false)}\n        runCode={selectedRun?.code}\n        runColor={selectedRun?.color}\n        currentDriver={selectedRun?.currentDriver}\n        dutyCount={selectedRun?.dutyIds.length || 0}\n        onAssign={handleRunAssignment}\n      />\n      </AssignmentContainer>\n    </PageContainer>\n  );\n};\n\nexport default AssignmentInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}